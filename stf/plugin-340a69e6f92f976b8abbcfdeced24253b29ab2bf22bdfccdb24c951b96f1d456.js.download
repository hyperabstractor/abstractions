define("discourse/plugins/discourse-akismet/discourse/akismet-route-map",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={resource:"admin.adminPlugins",path:"/plugins",map:function(){this.route("akismet")}}}),define("discourse/plugins/discourse-akismet/discourse/routes/admin-plugins-akismet",["exports","discourse/plugins/discourse-akismet/admin/models/akismet-queue"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=Discourse.Route.extend({_enabled:!1,_stats:null,model:function(){var e=this;return t.default.findAll().then(function(t){return e._enabled=t.enabled,e._stats=t.stats,t.posts})},setupController:function(e,t){e.setProperties({model:t,enabled:this._enabled,stats:this._stats})}})}),Ember.TEMPLATES["javascripts/admin/plugins-akismet"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["post"],"statements":[[4,"if",[[23,["enabled"]]],null,{"statements":[[4,"if",[[23,["stats"]]],null,{"statements":[[0,"    "],[7,"table"],[11,"class","tbl spam-stats"],[9],[0,"\\n      "],[7,"tr"],[9],[0,"\\n        "],[7,"th"],[9],[1,[27,"i18n",["akismet.stats.scanned"],null],false],[10],[0,"\\n        "],[7,"th"],[9],[1,[27,"i18n",["akismet.stats.needs_review"],null],false],[10],[0,"\\n        "],[7,"th"],[9],[1,[27,"i18n",["akismet.stats.confirmed_spam"],null],false],[10],[0,"\\n        "],[7,"th"],[9],[1,[27,"i18n",["akismet.stats.confirmed_ham"],null],false],[10],[0,"\\n      "],[10],[0,"\\n      "],[7,"tr"],[9],[0,"\\n        "],[7,"td"],[9],[1,[23,["stats","scanned"]],false],[10],[0,"\\n        "],[7,"td"],[9],[1,[23,["stats","needs_review"]],false],[10],[0,"\\n        "],[7,"td"],[9],[1,[23,["stats","confirmed_spam"]],false],[10],[0,"\\n        "],[7,"td"],[9],[1,[23,["stats","confirmed_ham"]],false],[10],[0,"\\n      "],[10],[0,"\\n    "],[10],[0,"\\n"]],"parameters":[]},null],[0,"\\n"],[4,"if",[[23,["currentUser","admin"]]],null,{"statements":[[0,"    "],[1,[27,"d-button",null,[["label","icon","class","action"],["admin.plugins.change_settings","gear","settings-button",[27,"route-action",["showSettings"],null]]]],false],[0,"\\n"]],"parameters":[]},null],[0,"\\n  "],[1,[27,"d-button",null,[["action","icon","class","label","disabled"],[[27,"action",[[22,0,[]],"refresh"],null],"refresh","btn-primary","akismet.refresh",[23,["performingAction"]]]]],false],[0,"\\n\\n"],[4,"if",[[23,["model","length"]]],null,{"statements":[[0,"    "],[7,"h3"],[11,"class","review-queue"],[9],[1,[27,"i18n",["akismet.posts_to_review"],null],false],[10],[0,"\\n\\n    "],[7,"div"],[11,"class","row"],[9],[0,"\\n      "],[7,"table"],[11,"class","akismet-queue"],[9],[0,"\\n        "],[7,"tbody"],[9],[0,"\\n"],[4,"each",[[23,["sortedPosts"]]],null,{"statements":[[0,"          "],[7,"tr"],[9],[0,"\\n            "],[7,"td"],[11,"class","cooked"],[9],[0,"\\n\\n              "],[7,"div"],[11,"class","post-info"],[9],[0,"\\n                "],[4,"link-to",["adminUser",[22,1,["user_id"]],[22,1,["username"]]],null,{"statements":[[1,[27,"avatar",[[22,1,[]]],[["imageSize"],["small"]]],false],[0," "],[1,[22,1,["username"]],false]],"parameters":[]},null],[0,"\\n                "],[7,"a"],[12,"href",[22,1,["url"]]],[11,"target","_blank"],[11,"class","post-link"],[9],[0,"#"],[1,[22,1,["id"]],false],[10],[0,"\\n              "],[10],[0,"\\n              "],[1,[22,1,["excerpt"]],true],[0,"\\n              "],[7,"div"],[11,"class","queue-actions"],[9],[0,"\\n                "],[1,[27,"d-button",null,[["action","actionParam","icon","class","label","disabled"],[[27,"action",[[22,0,[]],"confirmSpamPost"],null],[22,1,[]],"check","btn-primary","akismet.confirm_spam",[23,["performingAction"]]]]],false],[0,"\\n\\n                "],[1,[27,"d-button",null,[["action","actionParam","icon","label","disabled"],[[27,"action",[[22,0,[]],"allowPost"],null],[22,1,[]],"thumbs-o-up","akismet.not_spam",[23,["performingAction"]]]]],false],[0,"\\n\\n                "],[1,[27,"d-button",null,[["action","actionParam","icon","label","disabled"],[[27,"action",[[22,0,[]],"dismiss"],null],[22,1,[]],"times","akismet.dismiss",[23,["performingAction"]]]]],false],[0,"\\n\\n\\n"],[4,"if",[[22,1,["user_id"]]],null,{"statements":[[0,"                  "],[1,[27,"d-button",null,[["action","actionParam","icon","class","label","disabled"],[[27,"action",[[22,0,[]],"deleteUser"],null],[22,1,[]],"trash-o","btn-danger","akismet.confirm_delete",[23,["performingAction"]]]]],false],[0,"\\n"]],"parameters":[]},null],[0,"              "],[10],[0,"\\n            "],[10],[0,"\\n          "],[10],[0,"\\n"]],"parameters":[1]},null],[0,"        "],[10],[0,"\\n      "],[10],[0,"\\n    "],[10],[0,"\\n"]],"parameters":[]},null]],"parameters":[]},{"statements":[[4,"if",[[23,["currentUser","admin"]]],null,{"statements":[[0,"    "],[1,[27,"d-button",null,[["label","icon","class","action"],["akismet.change_settings","gear","settings-button",[27,"route-action",["showSettings"],null]]]],false],[0,"\\n"]],"parameters":[]},null],[0,"  "],[1,[27,"i18n",["akismet.not_enabled"],null],true],[0,"\\n"]],"parameters":[]}]],"hasEval":false}',meta:{moduleName:"javascripts/admin/plugins-akismet"}}),Ember.TEMPLATES["javascripts/connectors/site-map-links/akismet-review"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"if",[[23,["currentUser","staff"]]],null,{"statements":[[0,"  "],[7,"li"],[9],[0,"\\n"],[4,"link-to",["adminPlugins.akismet"],null,{"statements":[[0,"      "],[1,[27,"i18n",["akismet.title"],null],false],[0,"\\n"],[4,"if",[[23,["currentUser","akismet_review_count"]]],null,{"statements":[[0,"        "],[7,"span"],[11,"class","badge-notification flagged-posts"],[9],[1,[23,["currentUser","akismet_review_count"]],false],[10],[0,"\\n"]],"parameters":[]},null]],"parameters":[]},null],[0,"  "],[10],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/connectors/site-map-links/akismet-review"}}),Ember.TEMPLATES["javascripts/components/reviewable-akismet-post"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["&default"],"statements":[[1,[27,"reviewable-topic-link",null,[["reviewable","tagName"],[[23,["reviewable"]],""]]],false],[0,"\\n"],[7,"div"],[11,"class","post-contents-wrapper"],[9],[0,"\\n"],[1,[27,"reviewable-created-by",null,[["user","tagName"],[[23,["reviewable","target_created_by"]],""]]],false],[0,"\\n"],[7,"div"],[11,"class","post-contents"],[9],[0,"\\n  "],[1,[27,"reviewable-created-by-name",null,[["user","tagName"],[[23,["reviewable","target_created_by"]],""]]],false],[0,"\\n  "],[7,"div"],[11,"class","post-body"],[9],[0,"\\n    "],[1,[23,["reviewable","payload","post_cooked"]],true],[0,"\\n  "],[10],[0,"\\n  "],[14,1],[0,"\\n"],[10],[0,"\\n"],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/components/reviewable-akismet-post"}}),define("discourse/plugins/discourse-akismet/discourse/initializers/add-akismet-count",["exports","discourse/lib/plugin-api"],function(e,t){"use strict";function n(e){e.addFlagProperty("currentUser.akismet_review_count"),e.decorateWidget("hamburger-menu:admin-links",function(e){return e.attach("link",{route:"adminPlugins.akismet",label:"akismet.title",badgeCount:"akismet_review_count",badgeClass:"flagged-posts"})})}function s(e,t){e.subscribe("/akismet_counts",function(e){e&&t.set("akismet_review_count",e.akismet_review_count||0)})}Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"add-akismet-count",before:"register-discourse-location",after:"inject-objects",initialize:function(e){if(!e.lookup("site:main").get("reviewable_api_enabled")){var i=e.lookup("current-user:main");i&&i.get("staff")&&((0,t.withPluginApi)("0.4",n),s(e.lookup("message-bus:main"),i))}}}}),define("discourse/plugins/discourse-akismet/discourse/controllers/admin-plugins-akismet",["exports","discourse/plugins/discourse-akismet/admin/models/akismet-queue"],function(e,t){"use strict";function n(){bootbox.alert(I18n.t("generic_error"))}Object.defineProperty(e,"__esModule",{value:!0}),e.default=Ember.Controller.extend({sortedPosts:Ember.computed.sort("model","postSorting"),postSorting:["id:asc"],enabled:!1,performingAction:!1,actions:{refresh:function(){var e=this;this.set("performingAction",!0),t.default.findAll().then(function(t){e.set("stats",t.stats),e.set("model",t.posts)}).catch(n).finally(function(){e.set("performingAction",!1)})},confirmSpamPost:function(e){var s=this;this.set("performingAction",!0),t.default.confirmSpam(e).then(function(){s.get("model").removeObject(e),s.incrementProperty("stats.confirmed_spam"),s.decrementProperty("stats.needs_review")}).catch(n).finally(function(){s.set("performingAction",!1)})},allowPost:function(e){var s=this;this.set("performingAction",!0),t.default.allow(e).then(function(){s.incrementProperty("stats.confirmed_ham"),s.decrementProperty("stats.needs_review"),s.get("model").removeObject(e)}).catch(n).finally(function(){s.set("performingAction",!1)})},deleteUser:function(e){var s=this;bootbox.confirm(I18n.t("akismet.delete_prompt",{username:e.get("username")}),function(i){!0===i&&(s.set("performingAction",!0),t.default.deleteUser(e).then(function(){s.get("model").removeObject(e),s.incrementProperty("stats.confirmed_spam"),s.decrementProperty("stats.needs_review")}).catch(n).finally(function(){s.set("performingAction",!1)}))})},dismiss:function(e){var s=this;this.set("performingAction",!0),t.default.dismiss(e).then(function(){s.get("model").removeObject(e)}).catch(n).finally(function(){s.set("performingAction",!1)})}}})}),define("discourse/plugins/discourse-akismet/admin/models/akismet-queue",["exports","discourse/lib/ajax"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={confirmSpam:function(e){return(0,t.ajax)("/admin/plugins/akismet/confirm_spam",{type:"POST",data:{post_id:e.get("id")}})},allow:function(e){return(0,t.ajax)("/admin/plugins/akismet/allow",{type:"POST",data:{post_id:e.get("id")}})},dismiss:function(e){return(0,t.ajax)("/admin/plugins/akismet/dismiss",{type:"POST",data:{post_id:e.get("id")}})},deleteUser:function(e){return(0,t.ajax)("/admin/plugins/akismet/delete_user",{type:"DELETE",data:{user_id:e.get("user_id"),post_id:e.get("id")}})},findAll:function(){return(0,t.ajax)("/admin/plugins/akismet/index.json").then(function(e){return e.posts=e.posts.map(function(e){return Discourse.Post.create(e)}),e})}}}),define("discourse/plugins/discourse-canned-replies/components/canned-reply",["exports","discourse/lib/show-modal","discourse/plugins/discourse-canned-replies/lib/apply-reply"],function(e,t,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=Ember.Component.extend({isOpen:!1,actions:{toggle:function(){this.toggleProperty("isOpen")},apply:function(){var e=Discourse.__container__.lookup("controller:composer");(0,n.default)(this.get("reply.id"),this.get("reply.title"),this.get("reply.content"),e.model),this.appEvents.trigger("canned-replies:hide")},editReply:function(){var e=Discourse.__container__.lookup("controller:composer");e.send("closeModal"),(0,t.default)("edit-reply").setProperties({composerModel:e.composerModel,replyId:this.get("reply.id"),replyTitle:this.get("reply.title"),replyContent:this.get("reply.content")})}}})}),define("discourse/plugins/discourse-canned-replies/components/canned-replies-form",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=Ember.Component.extend({})}),define("discourse/plugins/discourse-canned-replies/lib/apply-reply",["exports","discourse/lib/ajax","discourse/lib/ajax-error"],function(e,t,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,s,i,o){if(o){var a={user:o.get("user.username"),original_poster:o.get("topic.details.created_by.username"),reply_to:o.get("post.reply_to_user.username"),last_user:o.get("topic.last_poster_username"),reply_to_or_last:o.get("post.reply_to_user.username")||o.get("topic.last_poster_username")};for(var r in a)a[r]&&(s=s.replace("%{"+r+"}",a[r]),i=i.replace("%{"+r+"}",a[r]))}o.appEvents.trigger("composer:insert-block",i),o&&!o.get("title")&&o.set("title",s),(0,t.ajax)("/canned_replies/"+e+"/use",{type:"PATCH"}).catch(n.popupAjaxError)}}),Ember.TEMPLATES["javascripts/components/canned-reply"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[7,"div"],[11,"class","canned-reply"],[9],[0,"\\n  "],[7,"div"],[11,"class","canned-reply-title"],[9],[0,"\\n    "],[1,[27,"d-button",null,[["class","action","icon"],["btn canned-replies-apply",[27,"action",[[22,0,[]],"apply"],null],"clipboard"]]],false],[0,"\\n\\n    "],[1,[27,"d-button",null,[["class","action","icon"],["btn canned-replies-edit",[27,"action",[[22,0,[]],"editReply"],null],"pencil"]]],false],[0,"\\n\\n    "],[7,"b"],[9],[1,[23,["reply","title"]],false],[10],[0,"\\n  "],[3,"action",[[22,0,[]],"toggle"]],[10],[0,"\\n\\n"],[4,"if",[[23,["isOpen"]]],null,{"statements":[[0,"    "],[7,"div"],[11,"class","canned-replies-content"],[9],[0,"\\n      "],[1,[27,"cook-text",[[23,["reply","content"]]],null],true],[0,"\\n    "],[10],[0,"\\n"]],"parameters":[]},null],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/components/canned-reply"}}),Ember.TEMPLATES["javascripts/components/canned-replies-form"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[7,"form"],[9],[0,"\\n  "],[7,"div"],[9],[0,"\\n    "],[7,"label"],[9],[7,"strong"],[9],[1,[27,"i18n",["canned_replies.title.name"],null],false],[10],[10],[0,"\\n    "],[1,[27,"input",null,[["class","value"],["canned-replies-form-title-input",[23,["title"]]]]],false],[0,"\\n  "],[10],[0,"\\n\\n  "],[7,"div"],[9],[0,"\\n    "],[7,"label"],[9],[7,"strong"],[9],[1,[27,"i18n",["canned_replies.content.name"],null],false],[10],[10],[0,"\\n    "],[1,[27,"d-editor",null,[["class","value"],["canned-replies-form-content-input",[23,["content"]]]]],false],[0,"\\n  "],[10],[0,"\\n"],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/components/canned-replies-form"}}),Ember.TEMPLATES["javascripts/connectors/editor-preview/canned-replies"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["r"],"statements":[[4,"if",[[23,["isVisible"]]],null,{"statements":[[0,"  "],[7,"div"],[11,"class","d-editor-preview"],[9],[0,"\\n"],[4,"conditional-loading-spinner",null,[["condition"],[[23,["loadingReplies"]]]],{"statements":[[0,"      "],[1,[27,"d-button",null,[["class","action","icon","label"],["btn canned-replies-new",[27,"action",[[22,0,[]],"newReply"],null],"plus","canned_replies.insert.new_button"]]],false],[0,"\\n      "],[1,[27,"text-field",null,[["class","value","placeholder"],["canned-replies-filter",[23,["listFilter"]],[27,"i18n",["canned_replies.filter_hint"],null]]]],false],[0,"\\n      "],[7,"a"],[11,"class","close pull-right"],[9],[1,[27,"d-icon",["times"],null],false],[3,"action",[[22,0,[]],"hide"]],[10],[0,"\\n\\n      "],[7,"hr"],[9],[10],[0,"\\n\\n"],[4,"each",[[23,["filteredReplies"]]],null,{"statements":[[0,"        "],[1,[27,"canned-reply",null,[["reply"],[[22,1,[]]]]],false],[0,"\\n"]],"parameters":[1]},null]],"parameters":[]},null],[0,"  "],[10],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/connectors/editor-preview/canned-replies"}}),Ember.TEMPLATES["javascripts/modal/canned-replies"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"d-modal-body",null,[["title","class","style"],["canned_replies.insert.modal_title","canned-replies-modal","overflow: visible"]],{"statements":[[0,"\\n"],[4,"conditional-loading-spinner",null,[["condition"],[[23,["loadingReplies"]]]],{"statements":[[0,"    "],[7,"div"],[11,"class","details"],[9],[0,"\\n      "],[7,"div"],[11,"class","reply-selector"],[9],[0,"\\n        "],[7,"div"],[11,"class","selector"],[9],[0,"\\n          "],[1,[27,"combo-box",null,[["id","valueAttribute","value","nameProperty","content","none"],["canned-replies-combobox","id",[23,["selectedReplyId"]],"title",[23,["replies"]],"canned_replies.insert.choose"]]],false],[0,"\\n        "],[10],[0,"\\n      "],[10],[0,"\\n\\n"],[4,"if",[[23,["selectedReply"]]],null,{"statements":[[0,"        "],[7,"div"],[11,"class","content"],[9],[0,"\\n          "],[7,"div"],[9],[0,"\\n            "],[1,[27,"cook-text",[[23,["selectedReply","content"]]],null],true],[0,"\\n          "],[10],[0,"\\n        "],[10],[0,"\\n"]],"parameters":[]},null],[0,"    "],[10],[0,"\\n"]],"parameters":[]},null]],"parameters":[]},null],[0,"\\n"],[7,"div"],[11,"class","modal-footer"],[9],[0,"\\n  "],[1,[27,"d-button",null,[["class","action","icon","label"],["btn pull-left canned-replies-new",[27,"action",[[22,0,[]],"newReply"],null],"plus","canned_replies.insert.new_button"]]],false],[0,"\\n\\n"],[4,"if",[[23,["selectedReply"]]],null,{"statements":[[0,"    "],[1,[27,"d-button",null,[["class","action","icon","label"],["btn pull-left canned-replies-edit","editReply","pencil","canned_replies.insert.edit_button"]]],false],[0,"\\n\\n    "],[1,[27,"d-button",null,[["class","action","icon","label"],["btn-primary pull-right canned-replies-apply","apply","clipboard","canned_replies.insert.insert_button"]]],false],[0,"\\n"]],"parameters":[]},null],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/modal/canned-replies"}}),Ember.TEMPLATES["javascripts/modal/new-reply"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"d-modal-body",null,[["title","class"],["canned_replies.add.modal_title","canned-replies-modal"]],{"statements":[[0,"  "],[1,[27,"canned-replies-form",null,[["title","content"],[[23,["newTitle"]],[23,["newContent"]]]]],false],[0,"\\n"]],"parameters":[]},null],[0,"\\n"],[7,"div"],[11,"class","modal-footer canned-replies-footer"],[9],[0,"\\n  "],[1,[27,"d-button",null,[["class","action","label","disabled"],["btn btn-primary new-reply-save-btn",[27,"action",[[22,0,[]],"save"],null],"save",[23,["disableSaveButton"]]]]],false],[0,"\\n\\n  "],[7,"a"],[9],[1,[27,"i18n",["cancel"],null],false],[3,"action",[[22,0,[]],"cancel"]],[10],[0,"\\n"],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/modal/new-reply"}}),Ember.TEMPLATES["javascripts/modal/edit-reply"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"d-modal-body",null,[["title","class"],["canned_replies.edit.modal_title","canned-replies-modal"]],{"statements":[[0,"  "],[1,[27,"canned-replies-form",null,[["title","content"],[[23,["replyTitle"]],[23,["replyContent"]]]]],false],[0,"\\n"]],"parameters":[]},null],[0,"\\n"],[7,"div"],[11,"class","modal-footer canned-replies-footer"],[9],[0,"\\n\\n  "],[1,[27,"d-button",null,[["class","action","label","disabled"],["btn btn-primary edit-reply-save-btn",[27,"action",[[22,0,[]],"save"],null],[23,["savingLabel"]],[23,["disableSaveButton"]]]]],false],[0,"\\n\\n  "],[7,"a"],[9],[1,[27,"i18n",["cancel"],null],false],[3,"action",[[22,0,[]],"cancel"]],[10],[0,"\\n\\n  "],[1,[27,"d-button",null,[["class","action","icon","disabled"],["btn-danger pull-right",[27,"action",[[22,0,[]],"remove"],null],"trash",[23,["saving"]]]]],false],[0,"\\n"],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/modal/edit-reply"}}),define("discourse/plugins/discourse-canned-replies/initializers/add-canned-replies-ui-builder",["exports","discourse/lib/plugin-api","discourse/lib/show-modal"],function(e,t,n){"use strict";function s(e){e.modifyClass("controller:composer",{actions:{showCannedRepliesButton:function(){this.site.mobileView?(0,n.default)("canned-replies").set("composerModel",this.model):(this.appEvents.trigger("composer:show-preview"),this.appEvents.trigger("canned-replies:show"))}}}),e.addToolbarPopupMenuOptionsCallback(function(){return{id:"canned_replies_button",icon:"clipboard",action:"showCannedRepliesButton",label:"canned_replies.composer_button_text"}})}Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"add-canned-replies-ui-builder",initialize:function(e){var n=e.lookup("site-settings:main");if(n.canned_replies_enabled){var i=e.lookup("current-user:main"),o=[];i&&i.groups&&(o=i.groups.map(function(e){return e.name.toLowerCase()}));var a=n.canned_replies_groups.split("|").filter(function(e){return e}).map(function(e){return e.toLowerCase()});i&&(i.staff||o.some(function(e){return a.includes(e)}))&&(0,t.withPluginApi)("0.5",s)}}}}),define("discourse/plugins/discourse-canned-replies/connectors/editor-preview/canned-replies",["exports","discourse/lib/show-modal","discourse/lib/ajax","discourse/lib/ajax-error","discourse-common/lib/get-owner"],function(e,t,n,s,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={setupComponent:function(e,t){t.set("isVisible",!1),t.set("loadingReplies",!1),t.set("replies",[]),t.set("filteredReplies",[]),t.appEvents.has("canned-replies:show")||t.appEvents.on("canned-replies:show",function(){t.send("show")}),t.appEvents.has("canned-replies:hide")||t.appEvents.on("canned-replies:hide",function(){t.send("hide")}),t.appEvents.on("composer:will-close",function(){t.appEvents.off("canned-replies:show"),t.appEvents.off("canned-replies:hide")}),t.addObserver("listFilter",function(){var e=t.get("listFilter").toLowerCase(),n=t.get("replies").map(function(t){return t.score=0,-1!==t.title.toLowerCase().indexOf(e)?t.score+=2:-1!==t.content.toLowerCase().indexOf(e)&&(t.score+=1),t}).filter(function(e){return 0!==e.score}).sort(function(e,t){return e.score!==t.score?e.score>t.score?-1:1:e.title!==t.title?e.title<t.title?-1:1:0});t.set("filteredReplies",n)})},actions:{show:function(){var e=this;$("#reply-control .d-editor-preview-wrapper > .d-editor-preview").hide(),this.set("isVisible",!0),this.set("loadingReplies",!0),(0,n.ajax)("/canned_replies").then(function(t){e.set("replies",t.replies),e.set("filteredReplies",t.replies)}).catch(s.popupAjaxError).finally(function(){e.set("loadingReplies",!1),Ember.run.schedule("afterRender",function(){$(".canned-replies-filter").focus()})})},hide:function(){$(".d-editor-preview-wrapper > .d-editor-preview").show(),this.set("isVisible",!1)},newReply:function(){var e=(0,i.getOwner)(this).lookup("controller:composer");e.send("closeModal"),(0,t.default)("new-reply").setProperties({newContent:e.model.reply})}}}}),define("discourse/plugins/discourse-canned-replies/controllers/canned-replies",["exports","discourse/mixins/modal-functionality","discourse/lib/show-modal","discourse/lib/ajax","ember-addons/ember-computed-decorators","discourse/lib/ajax-error","discourse/plugins/discourse-canned-replies/lib/apply-reply"],function(e,t,n,s,i,o,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,l;e.default=Ember.Controller.extend(t.default,(r=(0,i.observes)("selectedReplyId"),l={selectedReply:null,selectedReplyId:"",loadingReplies:!0,init:function(){this._super.apply(this,arguments),this.replies=[]},_updateSelection:function(){this.selectionChange()},onShow:function(){var e=this;(0,s.ajax)("/canned_replies").then(function(t){e.set("replies",t.replies),e.selectionChange()}).catch(o.popupAjaxError).finally(function(){return e.set("loadingReplies",!1)})},selectionChange:function(){var e=this.get("selectedReplyId"),t="";this.get("replies").forEach(function(n){if(n.id===e)return void(t=n)}),this.set("selectedReply",t)},actions:{apply:function(){(0,a.default)(this.get("selectedReplyId"),this.selectedReply.title,this.selectedReply.content,this.composerModel),this.send("closeModal")},newReply:function(){this.send("closeModal"),(0,n.default)("new-reply").setProperties({newContent:this.composerModel.reply})},editReply:function(){this.send("closeModal"),(0,n.default)("edit-reply").setProperties({replyId:this.get("selectedReplyId"),replyTitle:this.get("selectedReply.title"),replyContent:this.get("selectedReply.content")})}}},function(e,t,n,s,i){var o={};return Object.keys(s).forEach(function(e){o[e]=s[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(l,"_updateSelection",[r],Object.getOwnPropertyDescriptor(l,"_updateSelection"),l),l))}),define("discourse/plugins/discourse-canned-replies/controllers/edit-reply",["exports","discourse/mixins/modal-functionality","discourse/lib/show-modal","discourse/lib/ajax","ember-addons/ember-computed-decorators","discourse/lib/ajax-error"],function(e,t,n,s,i,o){"use strict";function a(e,t,n,s,i){var o={};return Object.keys(s).forEach(function(e){o[e]=s[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}Object.defineProperty(e,"__esModule",{value:!0});var r,l,u;e.default=Ember.Controller.extend(t.default,(r=(0,i.default)("saving"),l=(0,i.default)("replyTitle","replyContent","saving"),u={replyTitle:"",replyContent:"",replyId:"",saving:null,onShow:function(){this.setProperties({saving:null})},savingLabel:function(e){return null===e?"save":e?"saving":"saved"},disableSaveButton:function(e,t,n){return n||""===e||""===t},actions:{save:function(){var e=this;this.set("saving",!0),(0,s.ajax)("/canned_replies/"+this.get("replyId"),{type:"PATCH",data:{title:this.get("replyTitle"),content:this.get("replyContent")}}).catch(o.popupAjaxError).finally(function(){e.set("saving",!1),e.appEvents.trigger("canned-replies:show")})},remove:function(){var e=this;bootbox.confirm(I18n.t("canned_replies.edit.remove_confirm"),function(t){t&&(0,s.ajax)("/canned_replies/"+e.get("replyId"),{type:"DELETE"}).then(function(){e.send("closeModal"),e.site.mobileView?(0,n.default)("canned-replies"):e.appEvents.trigger("canned-replies:show")}).catch(o.popupAjaxError)})},cancel:function(){this.send("closeModal"),this.site.mobileView?(0,n.default)("canned-replies"):this.appEvents.trigger("canned-replies:show")}}},a(u,"savingLabel",[r],Object.getOwnPropertyDescriptor(u,"savingLabel"),u),a(u,"disableSaveButton",[l],Object.getOwnPropertyDescriptor(u,"disableSaveButton"),u),u))}),define("discourse/plugins/discourse-canned-replies/controllers/new-reply",["exports","discourse/mixins/modal-functionality","discourse/lib/show-modal","discourse/lib/ajax","ember-addons/ember-computed-decorators","discourse/lib/ajax-error"],function(e,t,n,s,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,r;e.default=Ember.Controller.extend(t.default,(a=(0,i.default)("newTitle","newContent"),r={newTitle:"",newContent:"",onShow:function(){this.setProperties({newTitle:"",newContent:""})},disableSaveButton:function(e,t){return""===e||""===t},actions:{save:function(){var e=this;(0,s.ajax)("/canned_replies",{type:"POST",data:{title:this.get("newTitle"),content:this.get("newContent")}}).then(function(){e.send("closeModal"),e.site.mobileView?(0,n.default)("canned-replies"):e.appEvents.trigger("canned-replies:show")}).catch(o.popupAjaxError)},cancel:function(){this.send("closeModal"),this.site.mobileView?(0,n.default)("canned-replies"):this.appEvents.trigger("canned-replies:show")}}},function(e,t,n,s,i){var o={};return Object.keys(s).forEach(function(e){o[e]=s[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(r,"disableSaveButton",[a],Object.getOwnPropertyDescriptor(r,"disableSaveButton"),r),r))}),function(e,t){function n(e){e.toggleClass("open")}var s=function(e){var t,n=e.createElement("details");if(!("open"in n))return!1;var s=e.body||function(){var n=e.documentElement;return t=!0,n.insertBefore(e.createElement("body"),n.firstElementChild||n.firstChild)}();n.innerHTML="<summary>a</summary>b",n.style.display="block",s.appendChild(n);var i=n.offsetHeight;return n.open=!0,i=i!==n.offsetHeight,s.removeChild(n),t&&s.parentNode.removeChild(s),i}(e);t.fn.details=function(){return s?this:this.each(function(){var e=t(this),s=t("summary",e).first();s.prop("tabIndex",0),s.on("keydown",function(t){if(32===t.keyCode||13===t.keyCode)return n(e),!1}),s.on("click",function(){s.focus(),n(e)})})}}(document,jQuery),define("discourse/plugins/discourse-details/lib/discourse-markdown/details",["exports"],function(e){"use strict";function t(e){e.whiteList(["summary","summary[title]","details","details[open]","details.elided"]),e.registerPlugin(function(e){e.block.bbcode.ruler.push("details",n)})}Object.defineProperty(e,"__esModule",{value:!0}),e.setup=t;var n={tag:"details",before:function(e,t){var n=t.attrs;e.push("bbcode_open","details",1),e.push("bbcode_open","summary",1),e.push("text","",0).content=n._default||"",e.push("bbcode_close","summary",-1)},after:function(e){e.push("bbcode_close","details",-1)}}}),define("discourse/plugins/discourse-details/initializers/apply-details",["exports","discourse/lib/plugin-api"],function(e,t){"use strict";function n(e){e.decorateCooked(function(e){return $("details",e).details()}),e.addToolbarPopupMenuOptionsCallback(function(){return{action:"insertDetails",icon:"caret-right",label:"details.title"}}),e.modifyClass("controller:composer",{actions:{insertDetails:function(){this.get("toolbarEvent").applySurround('\n[details="'+I18n.t("composer.details_title")+'"]\n',"\n[/details]\n","details_text",{multiline:!1})}}})}Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"apply-details",initialize:function(){(0,t.withPluginApi)("0.8.7",n)}}}),function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};clearTimeout(this.timeout);var s=moment().utc(),o=n.time?n.date+" "+n.time:n.date,a=void 0,r=void 0;r=n.time?n.displayedTimezone||moment.tz.guess():n.displayedTimezone||n.timezone||moment.tz.guess(),(a=n.timezone?i(o,n.timezone):moment.utc(o))<s&&(n.recurring?a=u(a,n.recurring):e.addClass("past"));var c=a.tz(r),h=d(c.clone(),r,n),b=p(h),v=f(h),g=l(c,r,n);e.html(m).attr("aria-label",b).attr("data-html-tooltip",'<div class="locale-dates-previews">'+v+"</div>").addClass("cooked-date").find(".relative-time").text(g),this.timeout=setTimeout(function(){return t(e,n)},1e4)}function n(e){return e.replace("_"," ").replace("Etc/","").split("/")}function s(e){var t=n(e);return t[1]||t[0]}function i(e,t){return moment.tz(e,t).utc()}function o(e,t){var n=I18n.t("discourse_local_dates.relative_dates."+t,{time:"LT"});return e?n.split("LT").map(function(e){return"["+e+"]"}).join("LT"):"["+n.replace(" LT","")+"]"}function a(e){return{sameDay:o(e,"today"),nextDay:o(e,"tomorrow"),lastDay:o(e,"yesterday"),sameElse:"L"}}function r(e,t){return moment.tz(e).utcOffset()===moment.tz(t).utcOffset()}function l(e,t,i){var o=r(t,moment.tz.guess()),l=e.isBetween(moment().subtract(2,"days"),moment().add(1,"days").endOf("day"));return i.calendar&&l?o?e=i.time?e.calendar(null,a(i.time)):e.calendar(null,a(null)):(e=e.format(i.format),e=e.replace("TZ",""),e=e+" ("+s(t)+")"):i.time?(e=e.format(i.format),i.displayedTimezone&&!o?(e=e.replace("TZ",""),e=e+" ("+s(t)+")"):e=e.replace("TZ",n(t).join(": "))):(e=e.format(i.format),o?e=e.replace("TZ",s(t)):(e=e.replace("TZ",""),e=e+" ("+s(t)+")")),e}function u(e,t){var n=t.split("."),s=parseInt(n[0],10),i=n[1],o=moment().diff(e,i),a=Math.ceil(o+s),r=moment(e.format()).isDST(),l=e.add(a,i),u=moment(l.format()).isDST();return!r&&u&&l.subtract(1,"hour"),r&&!u&&l.add(1,"hour"),l}function c(e,t){return e.tz(t).format("LLL")+" → "+e.add(24,"hours").tz(t).format("LLL")}function d(e,t,n){var s=[],i=moment.tz.guess(),o=n.timezones.filter(function(e){return e!==i});return s.push({timezone:i,current:!0,dateTime:n.time?e.tz(i).format("LLL"):c(e,i)}),
n.timezone&&t===i&&n.timezone!==t&&!r(t,n.timezone)&&o.unshift(n.timezone),o.filter(function(e){return e}).forEach(function(o){r(o,t)||(r(o,i)&&(o=i),s.push({timezone:o,dateTime:n.time?e.tz(o).format("LLL"):c(e,o)}))}),s.length||s.push({timezone:"Etc/UTC",dateTime:n.time?e.tz("Etc/UTC").format("LLL"):c(e,"Etc/UTC")}),_.uniq(s,"timezone")}function p(e){return e.map(function(e){var t=s(e.timezone);return e.dateTime.match(/TZ/)?e.dateTime.replace(/TZ/,t):t+" "+e.dateTime}).join(", ")}function f(t){return t.map(function(t){var n=e(h);return t.current&&n.addClass("current"),n.find(".timezone").text(s(t.timezone)),n.find(".date-time").text(t.dateTime),n[0].outerHTML}).join("")}var m='\n    <span>\n      <svg class="fa d-icon d-icon-globe-americas svg-icon" xmlns="http://www.w3.org/2000/svg">\n        <use xlink:href="#globe-americas"></use>\n      </svg>\n      <span class="relative-time"></span>\n    </span>\n  ',h="\n    <div class='preview'>\n      <span class='timezone'></span>\n      <span class='date-time'></span>\n    </div>\n  ";e.fn.applyLocalDates=function(){return this.each(function(){var n=e(this),s={};s.time=n.attr("data-time"),s.date=n.attr("data-date"),s.recurring=n.attr("data-recurring"),s.timezones=(n.attr("data-timezones")||Discourse.SiteSettings.discourse_local_dates_default_timezones||"Etc/UTC").split("|"),s.timezone=n.attr("data-timezone"),s.calendar="on"===(n.attr("data-calendar")||"on"),s.displayedTimezone=n.attr("data-displayed-timezone"),s.format=n.attr("data-format")||(s.time?"LLL":"LL"),t(n,s)})}}(jQuery),define("discourse/plugins/discourse-local-dates/lib/discourse-markdown/discourse-local-dates",["exports","pretty-text/engines/discourse-markdown/bbcode-block"],function(e,t){"use strict";function n(e,n,i){var o=void 0,a={date:null,time:null,timezone:null,format:null,timezones:null,displayedTimezone:null},r=(0,t.parseBBCodeTag)("[date date"+n[1]+"]",0,n[1].length+11);if(a.date=r.attrs.date,a.format=r.attrs.format,a.calendar=r.attrs.calendar,a.time=r.attrs.time,a.timezone=r.attrs.timezone,a.recurring=r.attrs.recurring,a.timezones=r.attrs.timezones,a.displayedTimezone=r.attrs.displayedTimezone,o=new i.Token("span_open","span",1),o.attrs=[["data-date",i.md.utils.escapeHtml(a.date)]],!a.date.match(/\d{4}-\d{2}-\d{2}/))return void s(e,i,moment.invalid().format());if(a.time&&!a.time.match(/\d{2}:\d{2}(?::\d{2})?/))return void s(e,i,moment.invalid().format());var l=a.date;if(a.time&&(o.attrs.push(["data-time",i.md.utils.escapeHtml(a.time)]),l=l+" "+a.time),!moment(l).isValid())return void s(e,i,moment.invalid().format());if(o.attrs.push(["class","discourse-local-date"]),a.format&&o.attrs.push(["data-format",i.md.utils.escapeHtml(a.format)]),a.calendar&&o.attrs.push(["data-calendar",i.md.utils.escapeHtml(a.calendar)]),a.displayedTimezone&&moment.tz.names().includes(a.displayedTimezone)&&o.attrs.push(["data-displayed-timezone",i.md.utils.escapeHtml(a.displayedTimezone)]),a.timezones){var u=a.timezones.split("|").filter(function(e){return moment.tz.names().includes(e)});o.attrs.push(["data-timezones",i.md.utils.escapeHtml(u.join("|"))])}a.timezone&&moment.tz.names().includes(a.timezone)?(o.attrs.push(["data-timezone",i.md.utils.escapeHtml(a.timezone)]),l=moment.tz(l,a.timezone)):l=moment.utc(l),a.recurring&&o.attrs.push(["data-recurring",i.md.utils.escapeHtml(a.recurring)]),e.push(o);var c=l.tz("Etc/UTC").format(i.md.options.discourse.datesEmailFormat||moment.defaultFormat);o.attrs.push(["data-email-preview",c+" UTC"]),s(e,i,l.utc().format(a.format))}function s(e,t,n){var s=void 0;s=new t.Token("text","",0),s.content=n,e.push(s),s=new t.Token("span_close","span",-1),e.push(s)}function i(e){e.whiteList(["span.discourse-local-date","span[data-*]","span[aria-label]"]),e.registerOptions(function(e,t){e.datesEmailFormat=t.discourse_local_dates_email_format,e.features["discourse-local-dates"]=!!t.discourse_local_dates_enabled}),e.registerPlugin(function(e){var t={matcher:/\[date(=.+?)\]/,onMatch:n};e.core.textPostProcess.ruler.push("discourse-local-dates",t)})}Object.defineProperty(e,"__esModule",{value:!0}),e.setup=i}),define("discourse/plugins/discourse-local-dates/discourse/components/discourse-local-dates-create-form",["exports","discourse/lib/computed","discourse/lib/load-script","ember-addons/ember-computed-decorators","discourse/lib/text","discourse/lib/debounce"],function(e,t,n,s,i,o){"use strict";function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t,n,s,i){var o={};return Object.keys(s).forEach(function(e){o[e]=s[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}Object.defineProperty(e,"__esModule",{value:!0});var l,u,c,d,p,f,m,h,b,v,g,_,y,w;e.default=Ember.Component.extend((l=(0,s.default)("date","toDate","toTime"),u=(0,s.default)("computedConfig","isRange"),c=(0,s.default)("date","time","isRange","options.{format,timezone}"),d=(0,s.default)("toDate","toTime","isRange","options.{timezone,format}"),p=(0,s.default)("recurring","timezones","timezone","format"),f=(0,s.default)("fromConfig.{date}","toConfig.{date}","options.{recurring,timezones,timezone,format}"),m=(0,s.default)("currentUserTimezone"),h=(0,s.default)("formats"),b=(0,s.default)("advancedMode"),v=(0,s.default)("computedConfig.{from,to,options}","options","isValid","isRange"),g=(0,s.default)("fromConfig.dateTime"),_=(0,s.default)("toConfig.dateTime","toSelected"),w={timeFormat:"HH:mm:ss",dateFormat:"YYYY-MM-DD",dateTimeFormat:"YYYY-MM-DD HH:mm:ss",date:null,toDate:null,time:null,toTime:null,format:null,formats:null,recurring:null,advancedMode:!1,isValid:!0,timezone:null,fromSelected:null,fromFilled:Ember.computed.notEmpty("date"),toSelected:null,toFilled:Ember.computed.notEmpty("toDate"),init:function(){this._super.apply(this,arguments),this._picker=null,this.setProperties({timezones:[],formats:(this.siteSettings.discourse_local_dates_default_formats||"").split("|").filter(function(e){return e}),timezone:moment.tz.guess(),date:moment().format(this.dateFormat)})},didInsertElement:function(){var e=this;this._super.apply(this,arguments),this._setupPicker().then(function(t){e._picker=t,e.send("focusFrom")})},_renderPreview:(0,o.default)(function(){var e=this,t=this.get("markup");t&&(0,i.cookAsync)(t).then(function(t){e.set("currentPreview",t),Ember.run.schedule("afterRender",function(){return e.$(".preview .discourse-local-date").applyLocalDates()})})},250).observes("markup"),isRange:function(e,t,n){return e&&(t||n)}},a(w,"isValid",function(e,t){var n=e.from;if(!e.from.dateTime||!e.from.dateTime.isValid())return!1;if(t){var s=e.to;if(!s.dateTime||!s.dateTime.isValid()||s.dateTime.diff(n.dateTime)<0)return!1}return!0}),a(w,"fromConfig",function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=!t,o=void 0;o=i?moment.tz(e,s.timezone):moment.tz(e+" "+t,s.timezone),i||(t=o.format(this.timeFormat));var a=s.format;return i&&this.get("formats").includes(a)&&(a="LL"),Ember.Object.create({date:o.format(this.dateFormat),time:t,dateTime:o,format:a,range:!!n&&"start"})}),a(w,"toConfig",function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=!t;t&&!e&&(e=moment().format(this.dateFormat));var o=void 0;o=i?moment.tz(e,s.timezone).endOf("day"):moment.tz(e+" "+t,s.timezone),i||(t=o.format(this.timeFormat));var a=s.format;return i&&this.get("formats").includes(a)&&(a="LL"),Ember.Object.create({date:o.format(this.dateFormat),time:t,dateTime:o,format:a,range:!!n&&"end"})}),a(w,"options",function(e,t,n,s){return Ember.Object.create({recurring:e,timezones:t,timezone:n,format:s})}),a(w,"computedConfig",function(e,t,n){return Ember.Object.create({from:e,to:t,options:n})}),a(w,"currentUserTimezone",function(){return moment.tz.guess()}),a(w,"timezoneIsDifferentFromUserTimezone",(0,t.propertyNotEqual)("currentUserTimezone","options.timezone")),a(w,"formatedCurrentUserTimezone",function(e){return e.replace("_"," ").replace("Etc/","").split("/")}),a(w,"previewedFormats",function(e){return e.map(function(e){return{format:e,preview:moment().format(e)}})}),a(w,"recurringOptions",function(){var e="discourse_local_dates.create.form.recurring";return[{name:I18n.t(e+".every_day"),id:"1.days"},{name:I18n.t(e+".every_week"),id:"1.weeks"},{name:I18n.t(e+".every_two_weeks"),id:"2.weeks"},{name:I18n.t(e+".every_month"),id:"1.months"},{name:I18n.t(e+".every_two_months"),id:"2.months"},{name:I18n.t(e+".every_three_months"),id:"3.months"},{name:I18n.t(e+".every_six_months"),id:"6.months"},{name:I18n.t(e+".every_year"),id:"1.years"}]}),a(w,"_generateDateMarkup",function(e,t,n){var s="[date="+e.date;return e.time&&(s+=" time="+e.time),e.format&&e.format.length&&(s+=' format="'+e.format+'"'),t.timezone&&(s+=' timezone="'+t.timezone+'"'),t.timezones&&t.timezones.length&&(s+=' timezones="'+t.timezones.join("|")+'"'),t.recurring&&!n&&(s+=' recurring="'+t.recurring+'"'),s+="]"}),a(w,"toggleModeBtnLabel",function(e){return e?"discourse_local_dates.create.form.simple_mode":"discourse_local_dates.create.form.advanced_mode"}),a(w,"markup",function(e,t,n,s){var i=void 0;return n&&e.from&&(i=this._generateDateMarkup(e.from,t,s),e.to&&e.to.range&&(i+=" → ",i+=this._generateDateMarkup(e.to,t,s))),i}),a(w,"formattedFrom",function(e){return e.format("LLLL")}),a(w,"formattedTo",function(e,t){var n=t?"&nbsp;":I18n.t("discourse_local_dates.create.form.until");return e.isValid()?e.format("LLLL"):n}),a(w,"actions",{setTime:function(e){this._setTimeIfValid(e.target.value,"time")},setToTime:function(e){this._setTimeIfValid(e.target.value,"toTime")},eraseToDateTime:function(){this.setProperties({toDate:null,toTime:null}),this._setPickerDate(null)},focusFrom:function(){this.setProperties({fromSelected:!0,toSelected:!1}),this._setPickerDate(this.get("fromConfig.date")),this._setPickerMinDate(null)},focusTo:function(){this.setProperties({toSelected:!0,fromSelected:!1}),this._setPickerDate(this.get("toConfig.date")),this._setPickerMinDate(this.get("fromConfig.date"))},advancedMode:function(){this.toggleProperty("advancedMode")},save:function(){var e=this.get("markup");e&&(this._closeModal(),this.get("toolbarEvent").addText(e))},cancel:function(){this._closeModal()}}),a(w,"_setTimeIfValid",function(e,t){if(Ember.isEmpty(e))return void this.set(t,null);/^(0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/.test(e)&&this.set(t,e)}),a(w,"_setupPicker",function(){var e=this;return new Ember.RSVP.Promise(function(t){(0,n.default)("/javascripts/pikaday.js").then(function(){var n={field:e.$(".fake-input")[0],container:e.$("#picker-container-"+e.elementId)[0],bound:!1,format:"YYYY-MM-DD",reposition:!1,firstDay:1,defaultDate:moment(e.get("date"),e.dateFormat).toDate(),setDefaultDate:!0,keyboardInput:!1,i18n:{previousMonth:I18n.t("dates.previous_month"),nextMonth:I18n.t("dates.next_month"),months:moment.months(),weekdays:moment.weekdays(),weekdaysShort:moment.weekdaysShort()},onSelect:function(t){var n=moment(t).format("YYYY-MM-DD");e.get("fromSelected")&&e.set("date",n),e.get("toSelected")&&e.set("toDate",n)}};t(new Pikaday(n))})})}),a(w,"_setPickerMinDate",function(e){var t=this;e&&!moment(e,this.dateFormat).isValid()&&(e=null),Ember.run.schedule("afterRender",function(){t._picker.setMinDate(moment(e,t.dateFormat).toDate())})}),a(w,"_setPickerDate",function(e){var t=this;e&&!moment(e,this.dateFormat).isValid()&&(e=null),Ember.run.schedule("afterRender",function(){t._picker.setDate(e,!0)})}),a(w,"_closeModal",function(){Discourse.__container__.lookup("controller:composer").send("closeModal")}),y=w,r(y,"isRange",[l],Object.getOwnPropertyDescriptor(y,"isRange"),y),r(y,"isValid",[u],Object.getOwnPropertyDescriptor(y,"isValid"),y),r(y,"fromConfig",[c],Object.getOwnPropertyDescriptor(y,"fromConfig"),y),r(y,"toConfig",[d],Object.getOwnPropertyDescriptor(y,"toConfig"),y),r(y,"options",[p],Object.getOwnPropertyDescriptor(y,"options"),y),r(y,"computedConfig",[f],Object.getOwnPropertyDescriptor(y,"computedConfig"),y),r(y,"currentUserTimezone",[s.default],Object.getOwnPropertyDescriptor(y,"currentUserTimezone"),y),r(y,"formatedCurrentUserTimezone",[m],Object.getOwnPropertyDescriptor(y,"formatedCurrentUserTimezone"),y),r(y,"previewedFormats",[h],Object.getOwnPropertyDescriptor(y,"previewedFormats"),y),r(y,"recurringOptions",[s.default],Object.getOwnPropertyDescriptor(y,"recurringOptions"),y),r(y,"toggleModeBtnLabel",[b],Object.getOwnPropertyDescriptor(y,"toggleModeBtnLabel"),y),r(y,"markup",[v],Object.getOwnPropertyDescriptor(y,"markup"),y),r(y,"formattedFrom",[g],Object.getOwnPropertyDescriptor(y,"formattedFrom"),y),r(y,"formattedTo",[_],Object.getOwnPropertyDescriptor(y,"formattedTo"),y),y))}),Ember.TEMPLATES["javascripts/components/discourse-local-dates-create-form"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["previewedFormat"],"statements":[[4,"d-modal-body",null,[["title","class","style"],["discourse_local_dates.title","discourse-local-dates-create-modal","overflow: auto"]],{"statements":[[0,"\\n  "],[7,"div"],[11,"class","form"],[9],[0,"\\n"],[4,"unless",[[23,["isValid"]]],null,{"statements":[[0,"      "],[7,"div"],[11,"class","validation-error alert alert-error"],[9],[0,"\\n        "],[1,[27,"i18n",["discourse_local_dates.create.form.invalid_date"],null],false],[0,"\\n      "],[10],[0,"\\n"]],"parameters":[]},{"statements":[[4,"if",[[23,["timezoneIsDifferentFromUserTimezone"]]],null,{"statements":[[0,"        "],[7,"div"],[11,"class","preview alert alert-info"],[9],[0,"\\n          "],[7,"b"],[9],[1,[21,"formatedCurrentUserTimezone"],false],[0," "],[10],[1,[21,"currentPreview"],false],[0,"\\n        "],[10],[0,"\\n"]],"parameters":[]},null]],"parameters":[]}],[0,"\\n    "],[1,[21,"computeDate"],false],[0,"\\n\\n    "],[7,"div"],[11,"class","date-time-configuration"],[9],[0,"\\n      "],[7,"div"],[11,"class","inputs-panel"],[9],[0,"\\n        "],[7,"div"],[12,"class",[28,["date-time-control from ",[27,"if",[[23,["fromSelected"]],"is-selected"],null]," ",[27,"if",[[23,["fromFilled"]],"is-filled"],null]]]],[9],[0,"\\n          "],[1,[27,"d-icon",["calendar-alt"],null],false],[0,"\\n          "],[1,[27,"d-button",null,[["action","translatedLabel","class"],[[27,"action",[[22,0,[]],"focusFrom"],null],[23,["formattedFrom"]],"date-time"]]],false],[0,"\\n        "],[10],[0,"\\n\\n        "],[7,"div"],[12,"class",[28,["date-time-control to ",[27,"if",[[23,["toSelected"]],"is-selected"],null]," ",[27,"if",[[23,["toFilled"]],"is-filled"],null]]]],[9],[0,"\\n          "],[1,[27,"d-icon",["calendar-alt"],null],false],[0,"\\n          "],[1,[27,"d-button",null,[["action","translatedLabel","class"],[[27,"action",[[22,0,[]],"focusTo"],null],[23,["formattedTo"]],"date-time"]]],false],[0,"\\n"],[4,"if",[[23,["toFilled"]]],null,{"statements":[[0,"            "],[1,[27,"d-button",null,[["icon","action","class"],["times",[27,"action",[[22,0,[]],"eraseToDateTime"],null],"delete-to-date"]]],false],[0,"\\n"]],"parameters":[]},null],[0,"        "],[10],[0,"\\n\\n"],[4,"unless",[[23,["site","mobileView"]]],null,{"statements":[[0,"          "],[1,[27,"timezone-input",null,[["headerIcon","value","onSelect"],["globe",[23,["timezone"]],[27,"action",[[22,0,[]],[27,"mut",[[23,["timezone"]]],null]],null]]]],false],[0,"\\n"]],"parameters":[]},null],[0,"      "],[10],[0,"\\n\\n      "],[7,"div"],[11,"class","picker-panel"],[9],[0,"\\n        "],[1,[27,"input",null,[["class"],["fake-input"]]],false],[0,"\\n        "],[7,"div"],[11,"class","date-picker"],[12,"id",[28,["picker-container-",[21,"elementId"]]]],[9],[10],[0,"\\n\\n"],[4,"if",[[23,["fromSelected"]]],null,{"statements":[[0,"          "],[7,"div"],[11,"class","time-pickers"],[9],[0,"\\n            "],[1,[27,"d-icon",["far-clock"],null],false],[0,"\\n            "],[1,[27,"input",null,[["maxlength","placeholder","input","type","value","class"],[5,"hh:mm",[27,"action",[[22,0,[]],"setTime"],null],"time",[27,"unbound",[[23,["time"]]],null],"time-picker"]]],false],[0,"\\n          "],[10],[0,"\\n"]],"parameters":[]},null],[0,"\\n"],[4,"if",[[23,["toSelected"]]],null,{"statements":[[4,"if",[[23,["toDate"]]],null,{"statements":[[0,"          "],[7,"div"],[11,"class","time-pickers"],[9],[0,"\\n            "],[1,[27,"d-icon",["far-clock"],null],false],[0,"\\n            "],[1,[27,"input",null,[["maxlength","placeholder","input","type","value","class"],[5,"hh:mm",[27,"action",[[22,0,[]],"setToTime"],null],"time",[27,"unbound",[[23,["toTime"]]],null],"time-picker"]]],false],[0,"\\n          "],[10],[0,"\\n"]],"parameters":[]},null]],"parameters":[]},null],[0,"      "],[10],[0,"\\n\\n"],[4,"if",[[23,["site","mobileView"]]],null,{"statements":[[0,"        "],[1,[27,"timezone-input",null,[["headerIcon","value","onSelect"],["globe",[23,["timezone"]],[27,"action",[[22,0,[]],[27,"mut",[[23,["timezone"]]],null]],null]]]],false],[0,"\\n"]],"parameters":[]},null],[0,"    "],[10],[0,"\\n\\n"],[4,"if",[[23,["advancedMode"]]],null,{"statements":[[0,"      "],[7,"div"],[11,"class","advanced-options"],[9],[0,"\\n"],[4,"unless",[[23,["isRange"]]],null,{"statements":[[0,"          "],[7,"div"],[11,"class","control-group recurrence"],[9],[0,"\\n            "],[7,"label"],[11,"class","control-label"],[9],[0,"\\n              "],[1,[27,"i18n",["discourse_local_dates.create.form.recurring_title"],null],false],[0,"\\n            "],[10],[0,"\\n            "],[7,"p"],[9],[1,[27,"i18n",["discourse_local_dates.create.form.recurring_description"],null],true],[10],[0,"\\n            "],[7,"div"],[11,"class","controls"],[9],[0,"\\n              "],[1,[27,"combo-box",null,[["content","class","value","onSelect","none"],[[23,["recurringOptions"]],"recurrence-input",[23,["recurring"]],[27,"action",[[22,0,[]],[27,"mut",[[23,["recurring"]]],null]],null],"discourse_local_dates.create.form.recurring_none"]]],false],[0,"\\n            "],[10],[0,"\\n          "],[10],[0,"\\n"]],"parameters":[]},null],[0,"\\n        "],[7,"div"],[11,"class","control-group format"],[9],[0,"\\n          "],[7,"label"],[9],[1,[27,"i18n",["discourse_local_dates.create.form.format_title"],null],false],[10],[0,"\\n          "],[7,"p"],[9],[0,"\\n            "],[1,[27,"i18n",["discourse_local_dates.create.form.format_description"],null],false],[0,"\\n            "],[7,"a"],[11,"target","_blank"],[11,"rel","noopener"],[11,"href","https://momentjs.com/docs/#/parsing/string-format/"],[9],[0,"\\n              "],[1,[27,"d-icon",["question-circle"],null],false],[0,"\\n            "],[10],[0,"\\n          "],[10],[0,"\\n          "],[7,"div"],[11,"class","controls"],[9],[0,"\\n            "],[1,[27,"text-field",null,[["value","class"],[[23,["format"]],"format-input"]]],false],[0,"\\n          "],[10],[0,"\\n        "],[10],[0,"\\n        "],[7,"div"],[11,"class","control-group"],[9],[0,"\\n          "],[7,"ul"],[11,"class","formats"],[9],[0,"\\n"],[4,"each",[[23,["previewedFormats"]]],null,{"statements":[[0,"              "],[7,"li"],[11,"class","format"],[9],[0,"\\n                "],[7,"a"],[11,"class","moment-format"],[11,"href",""],[9],[0,"\\n                  "],[1,[22,1,["format"]],false],[0,"\\n                "],[3,"action",[[22,0,[]],[27,"mut",[[23,["format"]]],null],[22,1,["format"]]]],[10],[0,"\\n                "],[7,"span"],[11,"class","previewed-format"],[9],[0,"\\n                  "],[1,[22,1,["preview"]],false],[0,"\\n                "],[10],[0,"\\n              "],[10],[0,"\\n"]],"parameters":[1]},null],[0,"          "],[10],[0,"\\n        "],[10],[0,"\\n\\n        "],[7,"div"],[11,"class","control-group timezones"],[9],[0,"\\n          "],[7,"label"],[9],[1,[27,"i18n",["discourse_local_dates.create.form.timezones_title"],null],false],[10],[0,"\\n          "],[7,"p"],[9],[1,[27,"i18n",["discourse_local_dates.create.form.timezones_description"],null],false],[10],[0,"\\n          "],[7,"div"],[11,"class","controls"],[9],[0,"\\n            "],[1,[27,"multi-select",null,[["class","allowAny","maximum","content","values"],["timezones-input",false,5,[23,["allTimezones"]],[23,["timezones"]]]]],false],[0,"\\n          "],[10],[0,"\\n        "],[10],[0,"\\n      "],[10],[0,"\\n"]],"parameters":[]},null],[0,"  "],[10],[0,"\\n"]],"parameters":[]},null],[0,"\\n"],[7,"div"],[11,"class","modal-footer discourse-local-dates-create-modal-footer"],[9],[0,"\\n"],[4,"if",[[23,["isValid"]]],null,{"statements":[[0,"    "],[1,[27,"d-button",null,[["class","action","label"],["btn btn-primary",[27,"action",[[22,0,[]],"save"],null],"discourse_local_dates.create.form.insert"]]],false],[0,"\\n"]],"parameters":[]},null],[0,"\\n  "],[7,"a"],[11,"class","cancel-action"],[11,"href",""],[9],[0,"\\n    "],[1,[27,"i18n",["cancel"],null],false],[0,"\\n  "],[3,"action",[[22,0,[]],"cancel"]],[10],[0,"\\n\\n  "],[1,[27,"d-button",null,[["class","action","icon","label"],["btn-default advanced-mode-btn",[27,"action",[[22,0,[]],"advancedMode"],null],"cog",[23,["toggleModeBtnLabel"]]]]],false],[0,"\\n"],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/components/discourse-local-dates-create-form"}}),Ember.TEMPLATES["javascripts/modal/discourse-local-dates-create-modal"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[1,[27,"discourse-local-dates-create-form",null,[["config","toolbarEvent"],[[23,["config"]],[23,["toolbarEvent"]]]]],false],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/modal/discourse-local-dates-create-modal"}}),define("discourse/plugins/discourse-local-dates/initializers/discourse-local-dates",["exports","discourse/lib/plugin-api","discourse/lib/show-modal"],function(e,t,n){"use strict";function s(e){e.decorateCooked(function(e){$(".discourse-local-date",e).applyLocalDates()}),e.onToolbarCreate(function(e){e.addButton({title:"discourse_local_dates.title",id:"local-dates",group:"extras",icon:"calendar-alt",sendAction:function(t){return e.context.send("insertDiscourseLocalDate",t)}})}),e.modifyClass("component:d-editor",{actions:{insertDiscourseLocalDate:function(e){(0,n.default)("discourse-local-dates-create-modal").setProperties({toolbarEvent:e})}}})}Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"discourse-local-dates",initialize:function(e){e.lookup("site-settings:main").discourse_local_dates_enabled&&(0,t.withPluginApi)("0.8.8",s)}}}),define("discourse/plugins/discourse-math/lib/discourse-markdown/discourse-math",["exports"],function(e){"use strict";function t(e,t,n){return e!==t&&(!!n.utils.isWhiteSpace(e)||(!!n.utils.isMdAsciiPunct(e)||!!n.utils.isPunctChar(e)))}function n(e,n,s){var i=e.pos,o=e.posMax;if(n||e.src.charCodeAt(i)!==s||o<i+2)return!1;if(e.src.charCodeAt(i+1)===s)return!1;if(i>0){if(!t(e.src.charCodeAt(i-1),s,e.md))return!1}for(var a=void 0,r=i+1;r<o;r++){if(e.src.charCodeAt(r)===s&&92!==e.src.charCodeAt(r-1)){a=r;break}}if(!a)return!1;if(a+1<=o){var l=e.src.charCodeAt(a+1);if(l&&!t(l,s,e.md))return!1}var u=e.src.slice(i+1,a),c=e.push("html_raw","",0),d=e.md.utils.escapeHtml(u),p=36===s?"'math'":"'asciimath'";return c.content="<span class="+p+">"+d+"</span>",e.pos=a+1,!0}function s(e,t){return n(e,t,36)}function i(e,t){return n(e,t,37)}function o(e,t,n,s){if(36!==e.src.charCodeAt(t))return!1;if(t++,36!==e.src.charCodeAt(t))return!1;t++;for(var i=t;i<n;i++)if(!s.utils.isSpace(e.src.charCodeAt(i)))return!1;return!0}function a(e,t,n,s){if(!o(e,e.bMarks[t]+e.tShift[t],e.eMarks[t],e.md))return!1;if(s)return!0;for(var i=t,a=!1;!(++i>=n);)if(o(e,e.bMarks[i]+e.tShift[i],e.eMarks[i],e.md)){a=!0;break}var r=e.push("html_raw","",0),l=a?e.eMarks[i-1]:e.eMarks[i],u=e.src.slice(e.bMarks[t+1]+e.tShift[t+1],l),c=e.md.utils.escapeHtml(u);return r.content="<div class='math'>\n"+c+"\n</div>\n",e.line=a?i+1:i,!0}function r(e){if(e.markdownIt){var t=void 0;e.registerOptions(function(e,n){e.features.math=n.discourse_math_enabled,t=n.discourse_math_enable_asciimath}),e.registerPlugin(function(e){t&&e.inline.ruler.after("escape","asciimath",i),e.inline.ruler.after("escape","math",s),e.block.ruler.after("code","math",a,{alt:["paragraph","reference","blockquote","list"]})})}}Object.defineProperty(e,"__esModule",{value:!0}),e.setup=r}),define("discourse/plugins/discourse-math/initializers/discourse-math-mathjax",["exports","discourse/lib/plugin-api","discourse/lib/load-script"],function(e,t,n){"use strict";function s(e){if(!l){var t=["toMathML.js","Safe.js"];e.enable_accessibility&&t.push("[a11y]/accessibility-menu.js");var n={jax:["input/TeX","input/AsciiMath","input/MathML","output/CommonHTML"],TeX:{extensions:["AMSmath.js","AMSsymbols.js","autoload-all.js"]},extensions:t,showProcessingMessages:!1,root:Discourse.getURLWithCDN("/plugins/discourse-math/mathjax")};e.zoom_on_hover&&(n.menuSettings={zoom:"Hover"},n.MathEvents={hover:750}),window.MathJax=n,l=!0}}function i(e){return s(e),(0,n.default)("/plugins/discourse-math/mathjax/MathJax.2.7.5.js")}function o(e,t){var n=$(e);if(!n.data("applied-mathjax")){n.data("applied-mathjax",!0);var s=void 0,i=void 0;if(n.hasClass("math")){var o="DIV"===e.tagName?"div":"span",a="div"===o?"; mode=display":"";s=$("<"+o+' style="display: none;"><script type="math/tex'+a+'"><\/script></'+o+">"),i=s.children(),i.text(n.text()),n.after(s)}else n.hasClass("asciimath")&&(s=$('<span style="display: none;"><script type="math/asciimath"><\/script></span>'),i=s.children(),i.text(n.text()),n.after(s));Em.run.later(this,function(){window.MathJax.Hub.Queue(function(){e.parentElement&&null!==e.parentElement.offsetParent&&window.MathJax.Hub.Typeset(i[0],function(){n.remove(),s.show()})})},t?200:0)}}function a(e,t){if(e&&e.find){var n=void 0;if(n=t.enable_asciimath?e.find(".math, .asciimath"):e.find(".math"),n.length>0){var s=e.hasClass("d-editor-preview");i(t).then(function(){n.each(function(e,t){return o(t,s)})})}}}function r(e,t){e.decorateCooked(function(e){a(e,t)})}Object.defineProperty(e,"__esModule",{value:!0});var l=!1;e.default={name:"apply-math-mathjax",initialize:function(e){var n=e.lookup("site-settings:main"),s={zoom_on_hover:n.discourse_math_zoom_on_hover,enable_accessibility:n.discourse_math_enable_accessibility,enable_asciimath:n.discourse_math_enable_asciimath};n.discourse_math_enabled&&"mathjax"==n.discourse_math_provider&&(0,t.withPluginApi)("0.5",function(e){r(e,s)})}}}),define("discourse/plugins/discourse-math/initializers/discourse-math-katex",["exports","discourse/lib/plugin-api","discourse/lib/load-script"],function(e,t,n){"use strict";function s(){return(0,n.default)("/plugins/discourse-math/katex/katex.min.js").then(function(){return(0,n.default)("/plugins/discourse-math/katex/katex.min.css",{css:!0}).then(function(){return(0,n.default)("/plugins/discourse-math/katex/mhchem.min.js")})})}function i(e,t){var n=$(e),s="DIV"===e.tagName;if(!n.data("applied-katex")&&(n.data("applied-katex",!0),n.hasClass("math"))){var i=n.text();n.text(""),window.katex.render(i,e,{displayMode:s})}}function o(e){if(e&&e.find){var t=e.find(".math");if(t.length>0){var n=e.hasClass("d-editor-preview");s().then(function(){t.each(function(e,t){return i(t,n)})})}}}function a(e){e.decorateCooked(function(e){o(e)})}Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"apply-math-katex",initialize:function(e){var n=e.lookup("site-settings:main");n.discourse_math_enabled&&"katex"===n.discourse_math_provider&&(0,t.withPluginApi)("0.5",function(e){a(e)})}}}),define("discourse/plugins/discourse-narrative-bot/initializers/new-user-narrative",["exports","discourse/lib/plugin-api"],function(e,t){"use strict";function n(e){var t=e.container.lookup("message-bus:main"),n=e.getCurrentUser(),s=e.container.lookup("app-events:main");e.modifyClass("component:site-header",{didInsertElement:function(){this._super.apply(this,arguments),this.dispatch("header:search-context-trigger","header")}}),e.attachWidgetAction("header","headerSearchContextTrigger",function(){this.site.mobileView?this.state.skipSearchContext=!1:(this.state.contextEnabled=!0,this.state.searchContextType="topic")}),t&&n&&t.subscribe("/new_user_narrative/tutorial_search",function(){s.trigger("header:search-context-trigger")})}Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"new-user-narratve",initialize:function(e){e.lookup("site-settings:main").discourse_narrative_bot_enabled&&(0,t.withPluginApi)("0.8.7",n)}}}),define("discourse/plugins/discourse-patreon/discourse/routes/admin-plugins-patreon",["exports","discourse/models/group","discourse/lib/ajax","discourse/plugins/discourse-patreon/discourse/models/filter-rule"],function(e,t,n,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){var n=[],s=!0,i=!1,o=void 0;try{for(var a,r=e[Symbol.iterator]();!(s=(a=r.next()).done)&&(n.push(a.value),!t||n.length!==t);s=!0);}catch(e){i=!0,o=e}finally{try{!s&&r.return&&r.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();e.default=Discourse.Route.extend({model:function(){return Ember.RSVP.Promise.all([(0,n.ajax)("/patreon/list.json"),t.default.findAll({ignore_automatic:!0})]).then(function(e){var t=i(e,2),n=t[0],s=t[1];return{filters:n.filters,rewards:n.rewards,last_sync_at:n.last_sync_at,groups:s}})},setupController:function(e,t){var n=t.rewards,i=t.groups,o=_.map(t.filters,function(e,t){var o=e.map(function(e){return n[e]?" $"+n[e].amount_cents/100+" - "+n[e].title:""}),a=_.find(i,function(e){return e.id===parseInt(t)});return s.default.create({group:a.name,rewards:o,group_id:t,reward_ids:e})});e.setProperties({model:o,groups:i,rewards:n,last_sync_at:t.last_sync_at})}})}),define("discourse/plugins/discourse-patreon/discourse/patreon-route-map",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={resource:"admin.adminPlugins",path:"/plugins",map:function(){this.route("patreon")}}}),Ember.TEMPLATES["javascripts/admin/plugins-patreon"]=Ember.HTMLBars.template({id:null,
block:'{"symbols":["rule"],"statements":[[7,"section"],[11,"id","patreon"],[9],[0,"\\n  "],[7,"h1"],[9],[1,[27,"i18n",["patreon.header.rules"],null],false],[10],[0,"\\n  "],[7,"table"],[9],[0,"\\n    "],[7,"tr"],[9],[0,"\\n      "],[7,"th"],[9],[1,[27,"i18n",["patreon.group"],null],false],[10],[0,"\\n      "],[7,"th"],[9],[1,[27,"i18n",["patreon.rewards"],null],false],[10],[0,"\\n      "],[7,"th"],[9],[10],[0,"\\n    "],[10],[0,"\\n\\n"],[4,"each",[[23,["model"]]],null,{"statements":[[0,"      "],[7,"tr"],[11,"class",""],[9],[0,"\\n        "],[7,"td"],[9],[1,[22,1,["group"]],false],[10],[0,"\\n        "],[7,"td"],[9],[1,[22,1,["rewards"]],false],[10],[0,"\\n        "],[7,"td"],[9],[0,"\\n          "],[7,"div"],[11,"class","pull-right"],[9],[0,"\\n            "],[1,[27,"d-button",null,[["action","actionParam","icon","class","title"],["delete",[22,1,[]],"trash-o","delete btn-danger","patreon.delete"]]],false],[0,"\\n          "],[10],[0,"\\n        "],[10],[0,"\\n      "],[10],[0,"\\n"]],"parameters":[1]},null],[0,"\\n    "],[7,"tr"],[11,"class","new-filter"],[9],[0,"\\n      "],[7,"td"],[9],[1,[27,"combo-box",null,[["value","content"],[[23,["editing","group_id"]],[23,["groups"]]]]],false],[10],[0,"\\n      "],[7,"td"],[9],[1,[27,"list-setting",null,[["settingValue","choices","class"],[[23,["editing","reward_list"]],[23,["rewardsNames"]],"rewards"]]],false],[10],[0,"\\n      "],[7,"td"],[9],[0,"\\n        "],[7,"div"],[11,"class","pull-right"],[9],[0,"\\n          "],[1,[27,"d-button",null,[["action","icon","class","title"],["save","check","save btn-primary","patreon.save"]]],false],[0,"\\n        "],[10],[0,"\\n      "],[10],[0,"\\n    "],[10],[0,"\\n  "],[10],[0,"\\n\\n  "],[7,"p"],[9],[1,[27,"i18n",["patreon.help_text"],null],false],[10],[0,"\\n\\n  "],[1,[27,"d-button",null,[["action","icon","class","disabled","title","label"],["updateData","refresh","test",[23,["updatingData"]],"patreon.update_data","patreon.update_data"]]],false],[0,"\\n\\n"],[4,"if",[[23,["last_sync_at"]]],null,{"statements":[[0,"    "],[7,"span"],[11,"class","last_synced"],[9],[1,[27,"i18n",["patreon.last_synced"],null],false],[0,": "],[1,[27,"format-date",[[23,["last_sync_at"]]],[["leaveAgo"],["true"]]],true],[10],[0,"\\n"]],"parameters":[]},null],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/admin/plugins-patreon"}}),define("discourse/plugins/discourse-patreon/discourse/templates/connectors/admin-user-details/patreon",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={setupComponent:function(e,t){var n=e.model.patreon_email,s="https://patreon.com/members";n&&(s=s+"?query="+n),t.set("patron_url",s)},shouldRender:function(e,t){return t.siteSettings.patreon_enabled&&e.model.patreon_id}}}),Ember.TEMPLATES["javascripts/connectors/admin-user-details/patreon"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"if",[[22,0,["siteSettings","patreon_enabled"]]],null,{"statements":[[0,"  "],[7,"section"],[11,"class","details"],[9],[0,"\\n    "],[7,"h1"],[9],[1,[27,"i18n",["patreon.title"],null],false],[10],[0,"\\n    "],[7,"div"],[11,"class","display-row"],[9],[0,"\\n      "],[7,"div"],[11,"class","field"],[9],[1,[27,"i18n",["patreon.field.id"],null],false],[10],[0,"\\n      "],[7,"div"],[11,"class","value"],[9],[1,[23,["model","patreon_id"]],false],[10],[0,"\\n    "],[10],[0,"\\n"],[4,"if",[[23,["model","patreon_email"]]],null,{"statements":[[0,"    "],[7,"div"],[11,"class","display-row"],[9],[0,"\\n      "],[7,"div"],[11,"class","field"],[9],[1,[27,"i18n",["patreon.field.email"],null],false],[10],[0,"\\n      "],[7,"div"],[11,"class","value"],[9],[1,[23,["model","patreon_email"]],false],[10],[0,"\\n    "],[10],[0,"\\n"]],"parameters":[]},null],[4,"if",[[23,["model","patreon_amount_cents"]]],null,{"statements":[[0,"    "],[7,"div"],[11,"class","display-row"],[9],[0,"\\n      "],[7,"div"],[11,"class","field"],[9],[1,[27,"i18n",["patreon.field.amount_cents"],null],false],[10],[0,"\\n      "],[7,"div"],[11,"class","value"],[9],[1,[23,["model","patreon_amount_cents"]],false],[10],[0,"\\n    "],[10],[0,"\\n"]],"parameters":[]},null],[4,"if",[[23,["model","patreon_rewards"]]],null,{"statements":[[0,"    "],[7,"div"],[11,"class","display-row"],[9],[0,"\\n      "],[7,"div"],[11,"class","field"],[9],[1,[27,"i18n",["patreon.field.rewards"],null],false],[10],[0,"\\n      "],[7,"div"],[11,"class","value"],[9],[1,[23,["model","patreon_rewards"]],false],[10],[0,"\\n    "],[10],[0,"\\n"]],"parameters":[]},null],[4,"if",[[23,["model","patreon_declined_since"]]],null,{"statements":[[0,"    "],[7,"div"],[11,"class","display-row"],[9],[0,"\\n      "],[7,"div"],[11,"class","field"],[9],[1,[27,"i18n",["patreon.field.declined_since"],null],false],[10],[0,"\\n      "],[7,"div"],[11,"class","value"],[9],[1,[27,"format-date",[[23,["model","patreon_declined_since"]]],null],true],[10],[0,"\\n    "],[10],[0,"\\n"]],"parameters":[]},null],[0,"    "],[7,"div"],[11,"class","display-row"],[9],[0,"\\n      "],[7,"div"],[11,"class","field"],[9],[1,[27,"i18n",["patreon.field.more_details.label"],null],false],[10],[0,"\\n      "],[7,"div"],[11,"class","value"],[9],[7,"a"],[11,"target","_blank"],[12,"href",[28,[[21,"patron_url"]]]],[9],[1,[27,"d-icon",["external-link-alt"],null],false],[10],[10],[0,"\\n      "],[7,"div"],[11,"class","controls"],[9],[0,"\\n"],[4,"if",[[23,["model","patreon_email"]]],null,{"statements":[[0,"          "],[1,[27,"i18n",["patreon.field.more_details.help_text.email_available"],null],false],[0,"\\n"]],"parameters":[]},{"statements":[[0,"          "],[1,[27,"i18n",["patreon.field.more_details.help_text.email_not_available"],null],false],[0,"\\n"]],"parameters":[]}],[0,"      "],[10],[0,"\\n    "],[10],[0,"\\n  "],[10],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/connectors/admin-user-details/patreon"}}),define("discourse/plugins/discourse-patreon/discourse/controllers/admin-plugins-patreon",["exports","ember-addons/ember-computed-decorators","discourse/plugins/discourse-patreon/discourse/models/filter-rule","discourse/lib/ajax","discourse/lib/ajax-error"],function(e,t,n,s,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,a;e.default=Ember.Controller.extend((o=(0,t.default)("rewards"),a={prettyPrintReward:function(e){return"$"+e.amount_cents/100+" - "+e.title},rewardsNames:function(){var e=this;return _.filter(this.rewards,function(e){return e.id>=0}).map(function(t){return e.prettyPrintReward(t)})},editing:n.default.create({}),actions:{save:function(){var e=this,t=this.get("editing"),o=this.get("model");t.set("group",this.groups.find(function(e){return e.id===parseInt(t.get("group_id"))})),t.set("rewards_ids",_.filter(this.rewards,function(n){return t.get("reward_list").includes(e.prettyPrintReward(n))}).map(function(e){return e.id})),(0,s.ajax)("/patreon/list.json",{method:"POST",data:t.getProperties("group_id","rewards_ids")}).then(function(){var s=o.find(function(e){return e.get("group_id")===t.get("group_id")}),i=t.get("reward_list").replace(/\|/g,", ");s?(s.set("reward_list",i),s.set("rewards",i),s.set("rewards_ids",t.rewards_ids)):o.pushObject(n.default.create({group:t.get("group.name"),rewards:i})),e.set("editing",n.default.create({}))}).catch(i.popupAjaxError)},delete:function(e){var t=this.get("model");(0,s.ajax)("/patreon/list.json",{method:"DELETE",data:e.getProperties("group_id")}).then(function(){var n=t.find(function(t){return t.get("group_id")===e.get("group_id")});t.removeObject(n)}).catch(i.popupAjaxError)},updateData:function(){var e=this;this.set("updatingData",!0),(0,s.ajax)("/patreon/update_data.json",{method:"POST"}).catch(i.popupAjaxError).finally(function(){return e.set("updatingData",!1)}),this.messageBus.subscribe("/patreon/background_sync",function(){e.messageBus.unsubscribe("/patreon/background_sync"),e.set("updatingData",!1),bootbox.alert(I18n.t("patreon.refresh_page"),function(){window.location.pathname=Discourse.getURL("/admin/plugins/patreon")})})}}},function(e,t,n,s,i){var o={};return Object.keys(s).forEach(function(e){o[e]=s[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(a,"rewardsNames",[o],Object.getOwnPropertyDescriptor(a,"rewardsNames"),a),a))}),define("discourse/plugins/discourse-patreon/discourse/models/filter-rule",["exports","discourse/models/rest"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=t.default.extend({group_id:-1,reward_list:""})}),define("discourse/plugins/discourse-presence/discourse/components/composer-presence-display",["exports","discourse/lib/ajax","ember-addons/ember-computed-decorators"],function(e,t,n){"use strict";function s(e,t,n,s,i){var o={};return Object.keys(s).forEach(function(e){o[e]=s[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}Object.defineProperty(e,"__esModule",{value:!0}),e.bufferTime=e.keepAliveDuration=void 0;var i,o,a,r,l,u,c,d=e.keepAliveDuration=1e4,p=e.bufferTime=3e3;e.default=Ember.Component.extend((i=(0,n.on)("didInsertElement"),o=(0,n.observes)("action","post.id","topic.id"),a=(0,n.observes)("reply","title"),r=(0,n.on)("willDestroyElement"),l=(0,n.observes)("currentState"),u=(0,n.default)("presenceUsers","currentUser.id"),c={action:null,post:null,topic:null,reply:null,title:null,previousState:null,currentState:null,presenceUsers:null,channel:null,composerOpened:function(){this._lastPublish=new Date,Ember.run.once(this,"updateState")},composerStateChanged:function(){Ember.run.once(this,"updateState")},typing:function(){new Date-this._lastPublish>d&&this.publish({current:this.get("currentState")})},composerClosing:function(){this.publish({previous:this.get("currentState")}),Ember.run.cancel(this._pingTimer),Ember.run.cancel(this._clearTimer)},updateState:function(){var e=null,t=this.get("action");"reply"!==t&&"edit"!==t||(e={action:t},"reply"===t&&(e.topic_id=this.get("topic.id")),"edit"===t&&(e.post_id=this.get("post.id"))),this.set("previousState",this.get("currentState")),this.set("currentState",e)},currentStateChanged:function(){var e=this;this.get("channel")&&(this.messageBus.unsubscribe(this.get("channel")),this.set("channel",null)),this.clear(),["reply","edit"].includes(this.get("action"))&&this.publish({response_needed:!0,previous:this.get("previousState"),current:this.get("currentState")}).then(function(t){e.get("isDestroyed")||(e.set("presenceUsers",t.users),e.set("channel",t.messagebus_channel),t.messagebus_channel&&e.messageBus.subscribe(t.messagebus_channel,function(t){e.get("isDestroyed")||e.set("presenceUsers",t.users),e._clearTimer=Ember.run.debounce(e,"clear",d+p)},t.messagebus_id))})},clear:function(){this.get("isDestroyed")||this.set("presenceUsers",[])},publish:function(e){return this._lastPublish=new Date,this.currentUser.hide_profile_and_presence?Ember.RSVP.Promise.resolve():(0,t.ajax)("/presence/publish",{type:"POST",data:e})},users:function(e,t){return(e||[]).filter(function(e){return e.id!==t})},isReply:Ember.computed.equal("action","reply"),shouldDisplay:Ember.computed.gt("users.length",0)},s(c,"composerOpened",[i],Object.getOwnPropertyDescriptor(c,"composerOpened"),c),s(c,"composerStateChanged",[o],Object.getOwnPropertyDescriptor(c,"composerStateChanged"),c),s(c,"typing",[a],Object.getOwnPropertyDescriptor(c,"typing"),c),s(c,"composerClosing",[r],Object.getOwnPropertyDescriptor(c,"composerClosing"),c),s(c,"currentStateChanged",[l],Object.getOwnPropertyDescriptor(c,"currentStateChanged"),c),s(c,"users",[u],Object.getOwnPropertyDescriptor(c,"users"),c),c))}),define("discourse/plugins/discourse-presence/discourse/components/topic-presence-display",["exports","ember-addons/ember-computed-decorators","discourse/plugins/discourse-presence/discourse/components/composer-presence-display"],function(e,t,n){"use strict";function s(e,t,n,s,i){var o={};return Object.keys(s).forEach(function(e){o[e]=s[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}Object.defineProperty(e,"__esModule",{value:!0});var i,o,a,r,l;e.default=Ember.Component.extend((i=(0,t.on)("didInsertElement"),o=(0,t.on)("willDestroyElement"),a=(0,t.default)("topicId"),r=(0,t.default)("presenceUsers","currentUser.{id,ignored_users}"),l={topicId:null,presenceUsers:null,clear:function(){this.get("isDestroyed")||this.set("presenceUsers",[])},_inserted:function(){var e=this;this.clear(),this.messageBus.subscribe(this.get("channel"),function(t){e.get("isDestroyed")||e.set("presenceUsers",t.users),e._clearTimer=Ember.run.debounce(e,"clear",n.keepAliveDuration+n.bufferTime)},-2)},_destroyed:function(){Ember.run.cancel(this._clearTimer),this.messageBus.unsubscribe(this.get("channel"))},channel:function(e){return"/presence/topic/"+e},users:function(e,t){var n=t.ignored_users||[];return(e||[]).filter(function(e){return e.id!==t.id&&!n.includes(e.username)})},shouldDisplay:Ember.computed.gt("users.length",0)},s(l,"_inserted",[i],Object.getOwnPropertyDescriptor(l,"_inserted"),l),s(l,"_destroyed",[o],Object.getOwnPropertyDescriptor(l,"_destroyed"),l),s(l,"channel",[a],Object.getOwnPropertyDescriptor(l,"channel"),l),s(l,"users",[r],Object.getOwnPropertyDescriptor(l,"users"),l),l))}),Ember.TEMPLATES["javascripts/components/composer-presence-display"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["user"],"statements":[[4,"if",[[23,["shouldDisplay"]]],null,{"statements":[[0,"  "],[7,"div"],[11,"class","presence-users"],[9],[0,"\\n    "],[7,"div"],[11,"class","presence-avatars"],[9],[0,"\\n"],[4,"each",[[23,["users"]]],null,{"statements":[[0,"        "],[1,[27,"avatar",[[22,1,[]]],[["avatarTemplatePath","usernamePath","imageSize"],["avatar_template","username","small"]]],false],[0,"\\n"]],"parameters":[1]},null],[0,"    "],[10],[0,"\\n    "],[7,"span"],[11,"class","presence-text"],[9],[0,"\\n      "],[7,"span"],[11,"class","description"],[9],[0,"\\n"],[4,"if",[[23,["isReply"]]],null,{"statements":[[1,[27,"i18n",["presence.replying"],null],false]],"parameters":[]},{"statements":[[1,[27,"i18n",["presence.editing"],null],false]],"parameters":[]}],[10],[10],[7,"span"],[11,"class","wave"],[9],[7,"span"],[11,"class","dot"],[9],[0,"."],[10],[7,"span"],[11,"class","dot"],[9],[0,"."],[10],[7,"span"],[11,"class","dot"],[9],[0,"."],[10],[0,"\\n    "],[10],[0,"\\n  "],[10],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/components/composer-presence-display"}}),Ember.TEMPLATES["javascripts/components/topic-presence-display"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["user"],"statements":[[4,"if",[[23,["shouldDisplay"]]],null,{"statements":[[0,"  "],[7,"div"],[11,"class","presence-users"],[9],[0,"\\n    "],[7,"div"],[11,"class","presence-avatars"],[9],[0,"\\n"],[4,"each",[[23,["users"]]],null,{"statements":[[0,"        "],[1,[27,"avatar",[[22,1,[]]],[["avatarTemplatePath","usernamePath","imageSize"],["avatar_template","username","small"]]],false],[0,"\\n"]],"parameters":[1]},null],[0,"    "],[10],[0,"\\n    "],[7,"span"],[11,"class","presence-text"],[9],[0,"\\n      "],[7,"span"],[11,"class","description"],[9],[1,[27,"i18n",["presence.replying_to_topic"],[["count"],[[23,["users","length"]]]]],false],[10],[7,"span"],[11,"class","wave"],[9],[7,"span"],[11,"class","dot"],[9],[0,"."],[10],[7,"span"],[11,"class","dot"],[9],[0,"."],[10],[7,"span"],[11,"class","dot"],[9],[0,"."],[10],[10],[0,"\\n    "],[10],[0,"\\n  "],[10],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/components/topic-presence-display"}}),define("discourse/plugins/discourse-presence/discourse/templates/connectors/composer-fields/presence",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={shouldRender:function(e,t){return t.siteSettings.presence_enabled}}}),Ember.TEMPLATES["javascripts/connectors/composer-fields/presence"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[1,[27,"composer-presence-display",null,[["action","post","topic","reply","title"],[[23,["model","action"]],[23,["model","post"]],[23,["model","topic"]],[23,["model","reply"]],[23,["model","title"]]]]],false],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/connectors/composer-fields/presence"}}),define("discourse/plugins/discourse-presence/discourse/templates/connectors/topic-above-footer-buttons/presence",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={shouldRender:function(e,t){return t.siteSettings.presence_enabled}}}),Ember.TEMPLATES["javascripts/connectors/topic-above-footer-buttons/presence"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[1,[27,"topic-presence-display",null,[["topicId"],[[23,["model","id"]]]]],false],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/connectors/topic-above-footer-buttons/presence"}}),define("discourse/plugins/discourse-push-notifications/discourse/components/push-notification-config",["exports","ember-addons/ember-computed-decorators","discourse/lib/push-notifications"],function(e,t,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s;e.default=Ember.Component.extend((s={showSetting:function(){return this.siteSettings.desktop_push_notifications_enabled},actions:{change:function(e){e?(this.currentUser.set("custom_fields.discourse_push_notifications_prefer_push",!0),n.keyValueStore.setItem("prefer_push","true")):(this.currentUser.set("custom_fields.discourse_push_notifications_prefer_push",!1),n.keyValueStore.setItem("prefer_push",""))}}},function(e,t,n,s,i){var o={};return Object.keys(s).forEach(function(e){o[e]=s[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(s,"showSetting",[t.default],Object.getOwnPropertyDescriptor(s,"showSetting"),s),s))}),Ember.TEMPLATES["javascripts/components/push-notification-config"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"if",[[23,["showSetting"]]],null,{"statements":[[0,"  "],[7,"label"],[11,"class","checkbox-label"],[9],[0,"\\n    "],[7,"input"],[12,"checked",[23,["currentUser","custom_fields","discourse_push_notifications_prefer_push"]]],[12,"onclick",[27,"action",[[22,0,[]],"change"],[["value"],["target.checked"]]]],[11,"type","checkbox"],[9],[10],[0,"\\n    "],[1,[27,"i18n",["discourse_push_notifications.note"],null],false],[0,"\\n  "],[10],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/components/push-notification-config"}}),Ember.TEMPLATES["javascripts/connectors/user-preferences-desktop-notifications/user-push-notification-input"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[1,[21,"push-notification-config"],false],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/connectors/user-preferences-desktop-notifications/user-push-notification-input"}}),define("discourse/plugins/discourse-push-notifications/discourse/initializers/setup-push-notifications",["exports","discourse/lib/plugin-api","discourse/lib/push-notifications"],function(e,t,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"setup-push-notifications",initialize:function(e){(0,t.withPluginApi)("0.1",function(t){var s=e.lookup("site-settings:main");e.lookup("router:main"),e.lookup("site:main");!Ember.testing&&t.getCurrentUser()&&(s.desktop_push_notifications_enabled?(t.modifyClass("controller:preferences/notifications",{saveAttrNames:["muted_usernames","new_topic_duration_minutes","auto_track_topics_after_msecs","notification_level_when_replying","like_notification_frequency","allow_private_messages","custom_fields"]}),t.modifyClass("component:desktop-notification-config",{isPushNotificationsPreferred:function(){return!(!this.site.mobileView&&!n.keyValueStore.getItem("prefer_push"))&&(0,n.isPushNotificationsSupported)(this.site.mobileView)}}),t.getCurrentUser().custom_fields.discourse_push_notifications_prefer_push?n.keyValueStore.setItem("prefer_push","true"):n.keyValueStore.setItem("prefer_push","")):n.keyValueStore.setItem("prefer_push",""))})}}}),define("discourse/plugins/discourse-solved/discourse/routes/user-activity-solved",["exports","discourse/routes/user-activity-stream"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=t.default.extend({userActionType:15,noContentHelpKey:"solved.no_solutions"})}),define("discourse/plugins/discourse-solved/discourse/pre-initializers/extend-category-for-solved",["exports","ember-addons/ember-computed-decorators","discourse/models/category"],function(e,t,n){"use strict";function s(e,t,n,s,i){var o={};return Object.keys(s).forEach(function(e){o[e]=s[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"extend-category-for-solved",before:"inject-discourse-objects",initialize:function(){var e,i,o;n.default.reopen((e=(0,t.default)("custom_fields.enable_accepted_answers"),i={enable_accepted_answers:{get:function(e){return"true"===e},set:function(e){return e=e?"true":"false",this.set("custom_fields.enable_accepted_answers",e),e}}},s(i,"enable_accepted_answers",[e],(o=Object.getOwnPropertyDescriptor(i,"enable_accepted_answers"),o=o?o.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return o}}),i),i))}}}),define("discourse/plugins/discourse-solved/discourse/initializers/extend-for-solved-button",["exports","discourse/models/topic","discourse/models/user","discourse/raw-views/topic-status","discourse/helpers/topic-status-icons","discourse/lib/ajax-error","discourse/lib/plugin-api","discourse/lib/ajax","discourse/widgets/post-cooked","discourse/lib/utilities","discourse-common/lib/icon-library"],function(e,t,n,s,i,o,a,r,l,u,c){"use strict";function d(e){e.get("postStream.posts").forEach(function(e){e.get("post_number")>1&&(e.set("accepted_answer",!1),e.set("can_accept_answer",!0),e.set("can_unaccept_answer",!1))})}function p(e){if(e.get("can_unaccept_answer")){var t=e.topic;e.setProperties({can_accept_answer:!0,can_unaccept_answer:!1,accepted_answer:!1}),t.set("accepted_answer",void 0),(0,r.ajax)("/solution/unaccept",{type:"POST",data:{id:e.get("id")}}).catch(o.popupAjaxError)}}function f(e){var t=e.topic;d(t),e.setProperties({can_unaccept_answer:!0,can_accept_answer:!1,accepted_answer:!0}),t.set("accepted_answer",{username:e.get("username"),post_number:e.get("post_number"),excerpt:e.get("cooked")}),(0,r.ajax)("/solution/accept",{type:"POST",data:{id:e.get("id")}}).catch(o.popupAjaxError)}function m(e){var t=e.getCurrentUser();i.default.addObject(["has_accepted_answer","check-square-o","solved"]),e.includePostAttributes("can_accept_answer","can_unaccept_answer","accepted_answer"),e.addDiscoveryQueryParam&&e.addDiscoveryQueryParam("solved",{replace:!0,refreshModel:!0}),e.addPostMenuButton("solved",function(e){var n=e.can_accept_answer,s=e.can_unaccept_answer,i=e.accepted_answer,o=t&&t.id===e.topicCreatedById,a=i||!n||o?"first":"second-last-hidden";if(n)return{action:"acceptAnswer",icon:"check-square-o",className:"unaccepted",title:"solved.accept_answer",position:a};if(s||i){return{action:"unacceptAnswer",icon:"check-square",title:s?"solved.unaccept_answer":"solved.accepted_answer",className:"accepted fade-out",position:a,beforeButton:function(e){return e("span.accepted-text",I18n.t("solved.solution"))}}}}),e.decorateWidget("post-contents:after-cooked",function(e){if(1===e.attrs.post_number){var t=e.getModel();if(t){var n=t.get("topic");if(n.get("accepted_answer")){var s=!!n.get("accepted_answer").excerpt,i="\n            <aside class='quote accepted-answer' data-post=\""+n.get("accepted_answer").post_number+'" data-topic="'+n.get("id")+"\">\n              <div class='title'>\n                "+n.get("acceptedAnswerHtml")+' <div class="quote-controls"></div>\n              </div>\n              <blockquote>\n                '+n.get("accepted_answer").excerpt+"\n              </blockquote>\n            </aside>",o="\n            <aside class='quote accepted-answer'>\n              <div class='title title-only'>\n                "+n.get("acceptedAnswerHtml")+"\n              </div>\n            </aside>",a=new l.default({cooked:s?i:o}),r=a.init();return e.rawHtml(r)}}}}),e.attachWidgetAction("post","acceptAnswer",function(){var e=this,t=this.model,n=t.get("topic.postStream.posts").filter(function(e){return 1===e.get("post_number")||e.get("accepted_answer")});f(t),n.forEach(function(t){return e.appEvents.trigger("post-stream:refresh",{id:t.id})})}),e.attachWidgetAction("post","unacceptAnswer",function(){var e=this.model,t=e.get("topic.postStream.posts").find(function(e){return 1===e.get("post_number")});p(e),this.appEvents.trigger("post-stream:refresh",{id:t.get("id")})}),e.registerConnectorClass&&(e.registerConnectorClass("user-activity-bottom","solved-list",{shouldRender:function(e,t){return t.siteSettings.solved_enabled}}),e.registerConnectorClass("user-summary-stat","solved-count",{shouldRender:function(e,t){return t.siteSettings.solved_enabled&&e.model.solved_count>0},setupComponent:function(){this.set("classNames",["linked-stat"])}}))}Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"extend-for-solved-button",initialize:function(){t.default.reopen({acceptedAnswerHtml:function(){var e=this.get("accepted_answer.username"),t=this.get("accepted_answer.post_number");return e&&t?I18n.t("solved.accepted_html",{icon:(0,c.iconHTML)("check-square",{class:"accepted"}),username_lower:e.toLowerCase(),username:(0,u.formatUsername)(e),post_path:this.get("url")+"/"+t,post_number:t,user_path:n.default.create({username:e}).get("path")}):""}.property("accepted_answer","id")}),s.default.reopen({statuses:function(){var e=this._super();return this.topic.has_accepted_answer?e.push({openTag:"span",closeTag:"span",title:I18n.t("topic_statuses.solved.help"),icon:"check-square-o"}):this.topic.can_have_answer&&this.siteSettings.solved_enabled&&this.siteSettings.empty_box_on_unsolved&&e.push({openTag:"span",closeTag:"span",title:I18n.t("solved.has_no_accepted_answer"),icon:"square-o"}),e}.property()}),(0,a.withPluginApi)("0.1",m),(0,a.withPluginApi)("0.8.10",function(e){e.replaceIcon("notification.solved.accepted_notification","check-square")})}}}),Ember.TEMPLATES["javascripts/discourse/connectors/user-activity-bottom/solved-list"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"link-to",["userActivity.solved"],null,{"statements":[[0,"  "],[1,[27,"d-icon",["check-square"],null],false],[0," "],[1,[27,"i18n",["solved.title"],null],false],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/discourse/connectors/user-activity-bottom/solved-list"}}),Ember.TEMPLATES["javascripts/discourse/connectors/topic-after-cooked/solved-panel"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"if",[[23,["topic","accepted_answer"]]],null,{"statements":[[7,"p"],[11,"class","solved"],[9],[0,"\\n"],[1,[23,["topic","acceptedAnswerHtml"]],true],[0,"\\n"],[10],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/discourse/connectors/topic-after-cooked/solved-panel"}}),Ember.TEMPLATES["javascripts/discourse/connectors/category-custom-settings/solved-settings"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"unless",[[23,["siteSettings","allow_solved_on_all_topics"]]],null,{"statements":[[7,"section"],[11,"class","field"],[9],[0,"\\n  "],[7,"div"],[11,"class","enable-accepted-answer"],[9],[0,"\\n    "],[7,"label"],[11,"class","checkbox-label"],[9],[0,"\\n      "],[1,[27,"input",null,[["type","checked"],["checkbox",[23,["category","enable_accepted_answers"]]]]],false],[0,"\\n      "],[1,[27,"i18n",["solved.allow_accepted_answers"],null],false],[0,"\\n    "],[10],[0,"\\n  "],[10],[0,"\\n"],[10],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/discourse/connectors/category-custom-settings/solved-settings"}}),Ember.TEMPLATES["javascripts/discourse/connectors/user-summary-stat/solved-count"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"link-to",["userActivity.solved"],null,{"statements":[[0,"  "],[1,[27,"user-stat",null,[["value","label","icon"],[[23,["model","solved_count"]],"solved.solution_summary","check-square"]]],false],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/discourse/connectors/user-summary-stat/solved-count"}}),Ember.TEMPLATES["javascripts/discourse/connectors/bread-crumbs-right/solved-status-filter"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"if",[[23,["siteSettings","solved_enabled"]]],null,{"statements":[[0,"  "],[1,[27,"combo-box",null,[["content","value","valueAttribute","onSelect"],[[23,["statuses"]],[23,["status"]],"value",[27,"action",[[22,0,[]],"changeStatus"],null]]]],false],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/discourse/connectors/bread-crumbs-right/solved-status-filter"}}),define("discourse/plugins/discourse-solved/discourse/connectors/bread-crumbs-right/solved-status-filter",["exports","discourse/lib/url"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={shouldRender:function(e,t){if(t.siteSettings.show_filter_by_solved_status){if(t.siteSettings.allow_solved_on_all_topics)return!0;var n=Discourse.__container__.lookup("controller:navigation/category");return n&&n.get("category.enable_accepted_answers")}return!1},setupComponent:function(e,t){var n=["all","solved","unsolved"].map(function(e){return{name:I18n.t("solved.topic_status_filter."+e),value:e}});t.set("statuses",n);var s=window.location.search;s.match(/solved=yes/)?t.set("status","solved"):s.match(/solved=no/)?t.set("status","unsolved"):t.set("status","all")},actions:{changeStatus:function(e){var n=window.location,s=n.search,i=s.startsWith("?")?s.substr(1).split("&"):[];i=i.filter(function(e){return!e.startsWith("solved=")}),e&&"all"!==e&&(e="solved"===e?"yes":"no",i.push("solved="+e)),s=i.length>0?"?"+i.join("&"):"",t.default.routeTo(""+n.pathname+s+n.hash)}}}}),define("discourse/plugins/discourse-solved/discourse/solved-route-map",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={resource:"user.userActivity",map:function(){this.route("solved")}}}),function(e){function t(t){e("div.lazyYT",t).each(function(){e(this).replaceWith("<p>https://youtube.com/watch?v="+e(this).data("youtube-id")+"</p>")})}function n(e,t){var n="gray 0 0 "+t+"px",s="-webkit-user-select";a&&(n=t<=0?"0 0 0 0 gray":"0 0 "+t+"px .1px gray",s="-ms-user-select"),
r&&(s="-moz-user-select"),e.css("background-color","transparent").css("color","rgba(0,0,0,0)").css("text-shadow",n).css(s,"none")}function s(e,t){var n=t>0?"blur("+t+"px)":"";a?e.css("-ms-filter","progid:DXImageTransform.Microsoft.Blur(pixelradius="+t+")"):e.css("filter",n).css("-webkit-filter",n)}function i(t,n){e("a",t).addClass("no-track-link"),e("a,pre",t).each(function(t,i){s(e(i),n)})}function o(t,n){var i=e("img",t);a?i.css("opacity",0===n?"1.0":"0.0"):s(i,n)}var a=document.documentMode,r="undefined"!=typeof InstallTrigger,l={max:{text:10,link:10,image:20},partial:{text:5,link:5,image:6},none:{text:0,link:0,image:0}},u=function(e,s){t(e),n(e,s.text),i(e,s.link),o(e,s.image)},c=function(e,t){var n=t.max,s=t.partial,i=t.none;e.data("spoiler-state","blurred"),u(e,n),e.on("mouseover",function(){e.css("cursor","pointer"),"blurred"===e.data("spoiler-state")&&u(e,s)}).on("mouseout",function(){"blurred"===e.data("spoiler-state")&&u(e,n)}).on("click",function(t){"blurred"===e.data("spoiler-state")?(e.data("spoiler-state","revealed").css("cursor","auto"),u(e,i),t.preventDefault()):t.target&&"A"!==t.target.tagName&&(e.data("spoiler-state","blurred").css("cursor","pointer"),u(e,s),t.preventDefault())})};e.fn.spoil=function(t){var n=e.extend(l,t||{});return this.each(function(){c(e(this),n)})}}(jQuery),define("discourse/plugins/discourse-spoiler-alert/lib/discourse-markdown/spoiler-alert",["exports","pretty-text/pretty-text"],function(e,t){"use strict";function n(e,t){var n=a.test(t)?"div":"span";return"<"+n+" class='spoiler'>"+t+"</"+n+">"}function s(e){for(e=e||"";e!==(e=e.replace(/\[spoiler\]((?:(?!\[spoiler\]|\[\/spoiler\])[\S\s])*)\[\/spoiler\]/gi,n)););return e}function i(e){e.registerOptions(function(e,t){e.features["spoiler-alert"]=!!t.spoiler_enabled}),e.registerPlugin(function(e){e.inline.bbcode.ruler.push("spoiler",{tag:"spoiler",wrap:"span.spoiler"}),e.block.bbcode.ruler.push("spoiler",{tag:"spoiler",wrap:"div.spoiler"})})}function o(e){e.whiteList(["span.spoiler","div.spoiler"]),e.markdownIt?i(e):e.addPreProcessor(s)}Object.defineProperty(e,"__esModule",{value:!0}),e.setup=o,(0,t.registerOption)(function(e,t){t.features["spoiler-alert"]=!!e.spoiler_enabled});var a=/\n|<img|!\[[^\]]*\][(\[]/}),define("discourse/plugins/discourse-spoiler-alert/initializers/spoiler-alert",["exports","discourse/lib/plugin-api","discourse/lib/to-markdown","discourse/controllers/composer"],function(e,t,n,s){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e){$(".spoiler",e).removeClass("spoiler").addClass("spoiled").spoil()}function l(e){e.decorateCooked(r),e.addToolbarPopupMenuOptionsCallback(function(){return{action:"insertSpoiler",icon:"magic",label:"spoiler.title"}}),s.default.reopen({actions:{insertSpoiler:function(){this.get("toolbarEvent").applySurround("[spoiler]","[/spoiler]","spoiler_text",{multiline:!1})}}}),n.Tag&&(n.Tag.prototype.decorate=function(e){return"spoiled"===this.element.attributes.class&&(this.prefix="[spoiler]",this.suffix="[/spoiler]"),(this.prefix||this.suffix)&&(e=[this.prefix,e,this.suffix].join("")),this.inline&&(e=" "+e+" "),e},n.Tag.block=function(e,t,s){return function(n){function r(){i(this,r);var n=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t,s));return n.gap="\n\n",n}return a(r,n),u(r,[{key:"decorate",value:function(e){var t=this.element.attributes,n=this.element.parent;return"p"===this.name&&n&&"li"===n.name&&(this.gap=""),"div"===this.name&&"spoiled"===t.class&&(this.prefix="[spoiler]",this.suffix="[/spoiler]",e=e.trim()),""+this.gap+this.prefix+e+this.suffix+this.gap}}]),r}(n.Tag)})}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}();e.default={name:"apply-spoilers",initialize:function(e){e.lookup("site-settings:main").spoiler_enabled&&(0,t.withPluginApi)("0.5",l)}}}),define("discourse/plugins/discourse-staff-notes/discourse/components/show-staff-notes",["exports","ember-addons/ember-computed-decorators"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,s,i;e.default=Ember.Component.extend((n=(0,t.default)("count"),s={tagName:"",showCount:function(e){return e&&e>0},actions:{show:function(){this.sendAction("show")}}},function(e,t,n,s,i){var o={};return Object.keys(s).forEach(function(e){o[e]=s[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(s,"showCount",[n],(i=Object.getOwnPropertyDescriptor(s,"showCount"),i=i?i.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return i}}),s),s))}),Ember.TEMPLATES["javascripts/components/show-staff-notes"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[7,"a"],[11,"href",""],[11,"class","btn"],[9],[0,"\\n  "],[1,[27,"d-icon",["pencil"],null],false],[0,"\\n"],[4,"if",[[23,["showCount"]]],null,{"statements":[[0,"    "],[1,[27,"i18n",["staff_notes.show"],[["count"],[[23,["count"]]]]],false],[0,"\\n"]],"parameters":[]},{"statements":[[0,"    "],[1,[27,"i18n",["staff_notes.title"],null],false],[0,"\\n"]],"parameters":[]}],[3,"action",[[22,0,[]],"show"]],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/components/show-staff-notes"}}),Ember.TEMPLATES["javascripts/connectors/admin-dashboard-moderation-bottom/recent-staff-notes-report-table"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"if",[[23,["siteSettings","staff_notes_enabled"]]],null,{"statements":[[0,"  "],[1,[27,"admin-report",null,[["dataSourceName","startDate","endDate"],["staff_notes",[23,["lastWeek"]],[23,["endDate"]]]]],false],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/connectors/admin-dashboard-moderation-bottom/recent-staff-notes-report-table"}}),Ember.TEMPLATES["javascripts/modal/staff-notes"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["n"],"statements":[[4,"d-modal-body",null,[["class"],["staff-notes-modal"]],{"statements":[[0,"  "],[1,[27,"textarea",null,[["value"],[[23,["newNote"]]]]],false],[0,"\\n  "],[1,[27,"d-button",null,[["action","label","class","disabled"],["attachNote","staff_notes.attach","btn-primary",[23,["attachDisabled"]]]]],false],[0,"\\n  "],[7,"hr"],[9],[10],[0,"\\n\\n"],[4,"each",[[23,["model"]]],null,{"statements":[[0,"    "],[7,"div"],[11,"class","staff-note"],[9],[0,"\\n      "],[7,"div"],[11,"class","posted-by"],[9],[0,"\\n"],[4,"user-link",null,[["user"],[[22,1,["created_by"]]]],{"statements":[[0,"          "],[1,[27,"avatar",[[22,1,["created_by"]]],[["imageSize"],["small"]]],false],[0,"\\n"]],"parameters":[]},null],[0,"      "],[10],[0,"\\n      "],[7,"div"],[11,"class","note-contents"],[9],[0,"\\n        "],[7,"div"],[11,"class","note-info"],[9],[0,"\\n          "],[7,"span"],[11,"class","username"],[9],[1,[22,1,["created_by","username"]],false],[10],[0,"\\n          "],[7,"span"],[11,"class","post-date"],[9],[1,[27,"age-with-tooltip",[[22,1,["created_at"]]],null],false],[10],[0,"\\n\\n"],[4,"if",[[22,1,["can_delete"]]],null,{"statements":[[0,"            "],[7,"span"],[11,"class","controls"],[9],[0,"\\n              "],[1,[27,"d-button",null,[["action","icon","class","title"],[[27,"action",[[22,0,[]],"removeNote",[22,1,[]]],null],"trash-o","btn-small btn-danger","staff_notes.remove"]]],false],[0,"\\n            "],[10],[0,"\\n"]],"parameters":[]},null],[0,"        "],[10],[0,"\\n\\n        "],[7,"div"],[11,"class","cooked"],[9],[0,"\\n          "],[1,[27,"cook-text",[[22,1,["raw"]]],null],false],[0,"\\n        "],[10],[0,"\\n\\n"],[4,"if",[[22,1,["post_id"]]],null,{"statements":[[0,"          "],[7,"a"],[11,"class","btn btn-small"],[12,"href",[22,1,["post_url"]]],[9],[0,"\\n            "],[1,[27,"i18n",["staff_notes.show_post"],null],false],[0,"\\n          "],[10],[0,"\\n"]],"parameters":[]},null],[0,"      "],[10],[0,"\\n\\n      "],[7,"div"],[11,"class","clearfix"],[9],[10],[0,"\\n    "],[10],[0,"\\n"]],"parameters":[1]},null]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/modal/staff-notes"}}),define("discourse/plugins/discourse-staff-notes/discourse/adapters/staff-note",["exports","discourse/adapters/rest","discourse/lib/ajax"],function(e,t,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=t.default.extend({destroyRecord:function(e,t,s){var i=this.pathFor(e,t,s.get("id")),o=s.get("user_id");return(0,n.ajax)(i+"?user_id="+o,{method:"DELETE"})}})}),define("discourse/plugins/discourse-staff-notes/discourse/initializers/enable-staff-notes",["exports","discourse/lib/plugin-api","discourse-common/lib/icon-library","discourse/plugins/discourse-staff-notes/discourse-staff-notes/lib/staff-notes"],function(e,t,n,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"enable-staff-notes",initialize:function(e){var i=e.lookup("site-settings:main"),o=e.lookup("current-user:main");if(i.staff_notes_enabled&&o&&o.staff){var a=e.lookup("store:main");(0,t.withPluginApi)("0.8.15",function(e){function t(){var e=this;(0,s.showStaffNotes)(a,this.attrs.user_id,function(t){e.sendWidgetAction("refreshStaffNotes",t)},{postId:this.attrs.id})}e.attachWidgetAction("post","refreshStaffNotes",function(e){var t=this.model.get("user_custom_fields")||{};t.staff_notes_count=e,this.model.set("user_custom_fields",t)}),e.modifyClass("controller:user",{staffNotesCount:null,_modelChanged:function(){this.set("staffNotesCount",this.get("model.custom_fields.staff_notes_count")||0)}.observes("model").on("init"),actions:{showStaffNotes:function(){var e=this,t=this.get("model");(0,s.showStaffNotes)(a,t.get("id"),function(t){return e.set("staffNotesCount",t)})}}});var o=e.container.lookup("site:main").mobileView,r=o?"before":"after";e.decorateWidget("poster-name:"+r,function(e){if(!e.widget.settings.hideNotes){return(e.attrs.userCustomFields||{}).staff_notes_count>0?e.attach("staff-notes-icon"):void 0}}),e.decorateWidget("post-avatar:after",function(e){if(e.widget.settings.showNotes){return(e.attrs.userCustomFields||{}).staff_notes_count>0?e.attach("staff-notes-icon"):void 0}}),e.decorateWidget("post-admin-menu:after",function(e){return e.attach("post-admin-menu-button",{icon:"pencil",label:"staff_notes.attach",action:"showStaffNotes"})}),e.attachWidgetAction("post","showStaffNotes",t),e.createWidget("staff-notes-icon",{tagName:"span.staff-notes-icon",click:t,html:function(){return i.enable_emoji?this.attach("emoji",{name:"pencil"}):(0,n.iconNode)("sticky-note")}})})}}}}),define("discourse/plugins/discourse-staff-notes/discourse/controllers/staff-notes",["exports","ember-addons/ember-computed-decorators","discourse/lib/ajax-error"],function(e,t,n){"use strict";function s(e,t,n,s,i){var o={};return Object.keys(s).forEach(function(e){o[e]=s[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}Object.defineProperty(e,"__esModule",{value:!0});var i,o,a;e.default=Ember.Controller.extend((i=(0,t.on)("init"),o=(0,t.default)("newNote","saving"),a={newNote:null,saving:!1,user:null,reset:function(){this.setProperties({newNote:null,saving:!1,callback:null})},attachDisabled:function(e,t){return t||!e||0===e.length},_refreshCount:function(){var e=this.get("callback");e&&e(this.get("model.length"))},actions:{attachNote:function(){var e=this,t=this.store.createRecord("staff-note"),s=parseInt(this.get("userId"));this.set("saving",!0);var i={raw:this.get("newNote"),user_id:s},o=this.get("postId");o&&(i.post_id=parseInt(o)),t.save(i).then(function(){e.set("newNote",""),e.get("model").insertAt(0,t),e._refreshCount()}).catch(n.popupAjaxError).finally(function(){return e.set("saving",!1)})},removeNote:function(e){var t=this;bootbox.confirm(I18n.t("staff_notes.delete_confirm"),I18n.t("no_value"),I18n.t("yes_value"),function(s){s&&e.destroyRecord().then(function(){t.get("model").removeObject(e),t._refreshCount()}).catch(n.popupAjaxError)})}}},s(a,"reset",[i],Object.getOwnPropertyDescriptor(a,"reset"),a),s(a,"attachDisabled",[o],Object.getOwnPropertyDescriptor(a,"attachDisabled"),a),a))}),define("discourse/plugins/discourse-staff-notes/discourse-staff-notes/lib/staff-notes",["exports","discourse/lib/show-modal","discourse/lib/load-script"],function(e,t,n){"use strict";function s(e,s,i,o){return o=o||{},(0,n.default)("defer/html-sanitizer-bundle").then(function(){return e.find("staff-note",{user_id:s}).then(function(e){var n=(0,t.default)("staff-notes",{model:e,title:"staff_notes.title",addModalBodyView:!0});return n.reset(),n.set("userId",s),n.set("callback",i),n.set("postId",o.postId),n})})}Object.defineProperty(e,"__esModule",{value:!0}),e.showStaffNotes=s}),Ember.TEMPLATES["javascripts/discourse-staff-notes/templates/connectors/flagged-post-controls/show-staff-notes-on-flags"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"if",[[23,["staffNotesCount"]]],null,{"statements":[[0,"  "],[1,[27,"show-staff-notes",null,[["show","count"],["showStaffNotes",[23,["staffNotesCount"]]]]],false],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/discourse-staff-notes/templates/connectors/flagged-post-controls/show-staff-notes-on-flags"}}),Ember.TEMPLATES["javascripts/discourse-staff-notes/templates/connectors/user-profile-controls/show-notes-on-profile"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[7,"li"],[9],[1,[27,"show-staff-notes",null,[["show","count"],["showStaffNotes",[23,["staffNotesCount"]]]]],false],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/discourse-staff-notes/templates/connectors/user-profile-controls/show-notes-on-profile"}}),Ember.TEMPLATES["javascripts/discourse-staff-notes/templates/connectors/admin-user-controls-after/add-staff-notes-button"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[1,[27,"show-staff-notes",null,[["show","count"],["showStaffNotes",[23,["staffNotesCount"]]]]],false],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/discourse-staff-notes/templates/connectors/admin-user-controls-after/add-staff-notes-button"}}),Ember.TEMPLATES["javascripts/discourse-staff-notes/templates/connectors/user-card-post-names/show-staff-notes-on-card"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"if",[[23,["staffNotesCount"]]],null,{"statements":[[0,"  "],[7,"a"],[11,"href",""],[12,"title",[28,[[21,"staffNotesTitle"]]]],[9],[0,"\\n"],[4,"if",[[23,["emojiEnabled"]]],null,{"statements":[[0,"      "],[7,"img"],[12,"src",[21,"emojiUrl"]],[12,"title",[21,"staffNotesTitle"]],[11,"alt","pencil"],[11,"class","emoji"],[9],[10],[0,"\\n"]],"parameters":[]},{"statements":[[0,"      "],[1,[27,"d-icon",["sticky-note"],null],false],[0,"\\n"]],"parameters":[]}],[0,"  "],[3,"action",[[22,0,[]],"showStaffNotes"]],[10],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/discourse-staff-notes/templates/connectors/user-card-post-names/show-staff-notes-on-card"}}),define("discourse/plugins/discourse-staff-notes/discourse-staff-notes/connectors/flagged-post-controls/show-staff-notes-on-flags",["exports","discourse/plugins/discourse-staff-notes/discourse-staff-notes/lib/staff-notes","discourse-common/lib/get-owner"],function(e,t,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={shouldRender:function(e,t){return t.siteSettings.staff_notes_enabled},setupComponent:function(e,t){var n=e.flaggedPost.get("user");t.set("staffNotesCount",n.get("custom_fields.staff_notes_count")||0)},actions:{showStaffNotes:function(){var e=this,s=(0,n.getOwner)(this).lookup("store:main"),i=this.get("args.flaggedPost.user");(0,t.showStaffNotes)(s,i.get("id"),function(t){return e.set("staffNotesCount",t)})}}}}),define("discourse/plugins/discourse-staff-notes/discourse-staff-notes/connectors/user-profile-controls/show-notes-on-profile",["exports","discourse/plugins/discourse-staff-notes/discourse-staff-notes/lib/staff-notes","discourse-common/lib/get-owner"],function(e,t,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={shouldRender:function(e,t){var n=t.siteSettings,s=t.currentUser;return n.staff_notes_enabled&&s&&s.staff},setupComponent:function(e,t){var n=e.model;t.set("staffNotesCount",n.get("staff_notes_count")||n.get("custom_fields.staff_notes_count")||0)},actions:{showStaffNotes:function(){var e=this,s=(0,n.getOwner)(this).lookup("store:main"),i=this.get("args.model");(0,t.showStaffNotes)(s,i.get("id"),function(t){return e.set("staffNotesCount",t)})}}}}),define("discourse/plugins/discourse-staff-notes/discourse-staff-notes/connectors/admin-user-controls-after/add-staff-notes-button",["exports","discourse/plugins/discourse-staff-notes/discourse-staff-notes/connectors/user-profile-controls/show-notes-on-profile"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=t.default}),define("discourse/plugins/discourse-staff-notes/discourse-staff-notes/connectors/user-card-post-names/show-staff-notes-on-card",["exports","discourse/plugins/discourse-staff-notes/discourse-staff-notes/lib/staff-notes","discourse-common/lib/get-owner","discourse/lib/text"],function(e,t,n,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={shouldRender:function(e,t){var n=t.siteSettings,s=t.currentUser;return n.staff_notes_enabled&&s&&s.staff},setupComponent:function(e,t){var n=e.user,i=n.get("staff_notes_count")||n.get("custom_fields.staff_notes_count")||0;t.set("staffNotesCount",i),t.set("emojiEnabled",t.siteSettings.enable_emoji),t.set("emojiUrl",(0,s.emojiUrlFor)("pencil")),t.set("user",n),t.set("staffNotesTitle",I18n.t("staff_notes.show",{count:i}))},actions:{showStaffNotes:function(){var e=this;this.parentView.parentView._close();var s=(0,n.getOwner)(this).lookup("store:main"),i=this.get("args.user");(0,t.showStaffNotes)(s,i.get("id"),function(t){return e.set("staffNotesCount",t)})}}}}),Ember.TEMPLATES["javascripts/upgrade-header"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"unless",[[23,["versionCheck","upToDate"]]],null,{"statements":[[0,"  "],[1,[21,"upgrade-notice"],false],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/upgrade-header"}}),define("discourse/plugins/docker_manager/discourse/components/upgrade-notice",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=Ember.Component.extend({tagName:"tr",href:function(){return Discourse.getURL("/admin/upgrade")}.property()})}),Ember.TEMPLATES["javascripts/components/upgrade-notice"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"if",[[23,["currentUser","admin"]]],null,{"statements":[[0,"  "],[7,"th"],[11,"colspan","5"],[9],[1,[27,"i18n",["docker.upgrade"],null],false],[0," "],[7,"a"],[12,"href",[28,[[21,"href"]]]],[11,"data-auto-route","true"],[9],[1,[27,"i18n",["docker.perform_upgrade"],null],false],[10],[10],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/components/upgrade-notice"}}),function(e){"use strict";function t(e,t){var n,s,i,o=e.data("width"),a=e.data("height"),r=e.data("ratio")?e.data("ratio"):t.default_ratio,l=e.data("youtube-id"),u=e.data("youtube-title"),c=[],d=e.data("parameters")||"";r=r.split(":"),"number"==typeof o&&"number"==typeof a?(e.width(o),n=a+"px"):"number"==typeof o?(e.width(o),n=o*r[1]/r[0]+"px"):(o=e.width(),0===o&&(o=e.parent().width()),n=r[1]/r[0]*100+"%"),c.push('<div class="ytp-thumbnail">'),c.push('<div class="ytp-large-play-button"'),o<=640&&c.push(' style="transform: scale(0.563888888888889);"'),c.push(">"),c.push("<svg>"),c.push('<path fill-rule="evenodd" clip-rule="evenodd" fill="#1F1F1F" class="ytp-large-play-button-svg" d="M84.15,26.4v6.35c0,2.833-0.15,5.967-0.45,9.4c-0.133,1.7-0.267,3.117-0.4,4.25l-0.15,0.95c-0.167,0.767-0.367,1.517-0.6,2.25c-0.667,2.367-1.533,4.083-2.6,5.15c-1.367,1.4-2.967,2.383-4.8,2.95c-0.633,0.2-1.316,0.333-2.05,0.4c-0.767,0.1-1.3,0.167-1.6,0.2c-4.9,0.367-11.283,0.617-19.15,0.75c-2.434,0.034-4.883,0.067-7.35,0.1h-2.95C38.417,59.117,34.5,59.067,30.3,59c-8.433-0.167-14.05-0.383-16.85-0.65c-0.067-0.033-0.667-0.117-1.8-0.25c-0.9-0.133-1.683-0.283-2.35-0.45c-2.066-0.533-3.783-1.5-5.15-2.9c-1.033-1.067-1.9-2.783-2.6-5.15C1.317,48.867,1.133,48.117,1,47.35L0.8,46.4c-0.133-1.133-0.267-2.55-0.4-4.25C0.133,38.717,0,35.583,0,32.75V26.4c0-2.833,0.133-5.95,0.4-9.35l0.4-4.25c0.167-0.966,0.417-2.05,0.75-3.25c0.7-2.333,1.567-4.033,2.6-5.1c1.367-1.434,2.967-2.434,4.8-3c0.633-0.167,1.333-0.3,2.1-0.4c0.4-0.066,0.917-0.133,1.55-0.2c4.9-0.333,11.283-0.567,19.15-0.7C35.65,0.05,39.083,0,42.05,0L45,0.05c2.467,0,4.933,0.034,7.4,0.1c7.833,0.133,14.2,0.367,19.1,0.7c0.3,0.033,0.833,0.1,1.6,0.2c0.733,0.1,1.417,0.233,2.05,0.4c1.833,0.566,3.434,1.566,4.8,3c1.066,1.066,1.933,2.767,2.6,5.1c0.367,1.2,0.617,2.284,0.75,3.25l0.4,4.25C84,20.45,84.15,23.567,84.15,26.4z M33.3,41.4L56,29.6L33.3,17.75V41.4z"></path>'),c.push('<polygon fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" points="33.3,41.4 33.3,17.75 56,29.6"></polygon>'),c.push("</svg>"),c.push("</div>"),c.push("</div>"),c.push('<div class="html5-info-bar">'),c.push('<div class="html5-title">'),c.push('<div class="html5-title-text-wrapper">'),c.push('<a class="html5-title-text" target="_blank" tabindex="3100" href="https://www.youtube.com/watch?v=',l,'">'),void 0===u||null===u||""===u?c.push("youtube.com/watch?v="+l):c.push(u),c.push("</a>"),c.push("</div>"),c.push("</div>"),c.push("</div>"),e.css({"padding-bottom":n}).html(c.join("")),i=o>640?"maxresdefault.jpg":o>480?"sddefault.jpg":o>320?"hqdefault.jpg":o>120?"mqdefault.jpg":0===o?"hqdefault.jpg":"default.jpg",s=e.find(".ytp-thumbnail").css({"background-image":["url(//img.youtube.com/vi/",l,"/",i,")"].join("")}).addClass("lazyYT-image-loaded").on("click",function(n){n.preventDefault(),!e.hasClass("lazyYT-video-loaded")&&s.hasClass("lazyYT-image-loaded")&&e.html('<iframe src="//www.youtube.com/embed/'+l+"?autoplay=1&"+d+'" frameborder="0" allowfullscreen></iframe>').addClass("lazyYT-video-loaded"),t.onPlay&&t.onPlay(n,e)})}e.fn.lazyYT=function(n){var s={default_ratio:"16:9",callback:null,container_class:"lazyYT-container"},i=e.extend(s,n);return this.each(function(){t(e(this).addClass(i.container_class),i)})}}(jQuery),define("discourse/plugins/lazyYT/initializers/lazyYT",["exports","discourse/lib/plugin-api"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"apply-lazyYT",initialize:function(){(0,t.withPluginApi)("0.1",function(e){e.decorateCooked(function(t){0!==$(".lazyYT",t).length&&$(".lazyYT",t).lazyYT({onPlay:function(t,n){var s=parseInt(n.closest("article").data("post-id"));s&&e.preventCloak(s)}})})})}}}),define("discourse/plugins/poll/lib/discourse-markdown/poll",["exports"],function(e){"use strict";function t(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function n(e,n,s){var i=e.indexOf(n),o=e[i].level;for(e.splice.apply(e,[i,1].concat(t(s))),s[0].map=n.map;i<e.length;i++){var a=e[i].nesting;a<0&&o--,e[i].level=o,a>0&&o++}}function s(e,t){for(var n=e.length-1,s=[],i=[];e[n]!==t;n--){if(0===n)return;var o=e[n];if(0===o.level&&"ol"!==o.tag&&"ul"!==o.tag)return;if(1===o.level&&1===o.nesting){if("li"!==o.tag)return;s.push([o,i.reverse().join(" ")])}1===o.level&&1===o.nesting&&"li"===o.tag?i=[]:"text"!==o.type&&"inline"!==o.type||i.push(o.content)}return s.reverse()}function i(e,t){e.push("text","",0).content="[/"+t+"]"}function o(e){e.registerOptions(function(e,t){e.features.poll=!!t.poll_enabled,e.pollMaximumOptions=t.poll_maximum_options}),e.registerPlugin(function(e){e.block.bbcode.ruler.push("poll",y)})}function a(e){e.whiteList(["div.poll","div.poll-info","div.poll-container","div.poll-buttons","div[data-*]","span.info-number","span.info-text","span.info-label","a.button.cast-votes","a.button.toggle-results","li[data-*]"]),o(e)}function r(e,t){var n=e[0],s=e[1],i=e[2],o=e[3];n=u(n,s,i,o,t[0],7,-680876936),o=u(o,n,s,i,t[1],12,-389564586),i=u(i,o,n,s,t[2],17,606105819),s=u(s,i,o,n,t[3],22,-1044525330),n=u(n,s,i,o,t[4],7,-176418897),o=u(o,n,s,i,t[5],12,1200080426),i=u(i,o,n,s,t[6],17,-1473231341),s=u(s,i,o,n,t[7],22,-45705983),n=u(n,s,i,o,t[8],7,1770035416),o=u(o,n,s,i,t[9],12,-1958414417),i=u(i,o,n,s,t[10],17,-42063),s=u(s,i,o,n,t[11],22,-1990404162),n=u(n,s,i,o,t[12],7,1804603682),o=u(o,n,s,i,t[13],12,-40341101),i=u(i,o,n,s,t[14],17,-1502002290),s=u(s,i,o,n,t[15],22,1236535329),n=c(n,s,i,o,t[1],5,-165796510),o=c(o,n,s,i,t[6],9,-1069501632),i=c(i,o,n,s,t[11],14,643717713),s=c(s,i,o,n,t[0],20,-373897302),n=c(n,s,i,o,t[5],5,-701558691),o=c(o,n,s,i,t[10],9,38016083),i=c(i,o,n,s,t[15],14,-660478335),s=c(s,i,o,n,t[4],20,-405537848),n=c(n,s,i,o,t[9],5,568446438),o=c(o,n,s,i,t[14],9,-1019803690),i=c(i,o,n,s,t[3],14,-187363961),s=c(s,i,o,n,t[8],20,1163531501),n=c(n,s,i,o,t[13],5,-1444681467),o=c(o,n,s,i,t[2],9,-51403784),i=c(i,o,n,s,t[7],14,1735328473),s=c(s,i,o,n,t[12],20,-1926607734),n=d(n,s,i,o,t[5],4,-378558),o=d(o,n,s,i,t[8],11,-2022574463),i=d(i,o,n,s,t[11],16,1839030562),s=d(s,i,o,n,t[14],23,-35309556),n=d(n,s,i,o,t[1],4,-1530992060),o=d(o,n,s,i,t[4],11,1272893353),i=d(i,o,n,s,t[7],16,-155497632),s=d(s,i,o,n,t[10],23,-1094730640),n=d(n,s,i,o,t[13],4,681279174),o=d(o,n,s,i,t[0],11,-358537222),i=d(i,o,n,s,t[3],16,-722521979),s=d(s,i,o,n,t[6],23,76029189),n=d(n,s,i,o,t[9],4,-640364487),o=d(o,n,s,i,t[12],11,-421815835),i=d(i,o,n,s,t[15],16,530742520),s=d(s,i,o,n,t[2],23,-995338651),n=p(n,s,i,o,t[0],6,-198630844),o=p(o,n,s,i,t[7],10,1126891415),i=p(i,o,n,s,t[14],15,-1416354905),s=p(s,i,o,n,t[5],21,-57434055),n=p(n,s,i,o,t[12],6,1700485571),o=p(o,n,s,i,t[3],10,-1894986606),i=p(i,o,n,s,t[10],15,-1051523),s=p(s,i,o,n,t[1],21,-2054922799),n=p(n,s,i,o,t[8],6,1873313359),o=p(o,n,s,i,t[15],10,-30611744),i=p(i,o,n,s,t[6],15,-1560198380),s=p(s,i,o,n,t[13],21,1309151649),n=p(n,s,i,o,t[4],6,-145523070),o=p(o,n,s,i,t[11],10,-1120210379),i=p(i,o,n,s,t[2],15,718787259),s=p(s,i,o,n,t[9],21,-343485551),e[0]=v(n,e[0]),e[1]=v(s,e[1]),e[2]=v(i,e[2]),e[3]=v(o,e[3])}function l(e,t,n,s,i,o){return t=v(v(t,e),v(s,o)),v(t<<i|t>>>32-i,n)}function u(e,t,n,s,i,o,a){return l(t&n|~t&s,e,t,i,o,a)}function c(e,t,n,s,i,o,a){return l(t&s|n&~s,e,t,i,o,a)}function d(e,t,n,s,i,o,a){return l(t^n^s,e,t,i,o,a)}function p(e,t,n,s,i,o,a){return l(n^(t|~s),e,t,i,o,a)}function f(e){/[\x80-\xFF]/.test(e)&&(e=unescape(encodeURI(e)));var t,n=e.length,s=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)r(s,m(e.substring(t-64,t)));e=e.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(r(s,i),t=0;t<16;t++)i[t]=0;return i[14]=8*n,r(s,i),s}function m(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function h(e){for(var t="",n=0;n<4;n++)t+=w[e>>8*n+4&15]+w[e>>8*n&15];return t}function b(e){for(var t=0;t<e.length;t++)e[t]=h(e[t]);return e.join("")}function v(e,t){return e+t&4294967295}function g(e){return b(f(e))}Object.defineProperty(e,"__esModule",{value:!0}),e.setup=a;var _=["close","max","min","name","order","public","results","status","step","type"],y={tag:"poll",before:function(e,t,n){var s=e.push("text","",0);s.content=n,s.bbcode_attrs=t.attrs,s.bbcode_type="poll_open"},after:function(e,t,o){var a=s(e.tokens,t);if(!a)return i(e,o);var r=t.bbcode_attrs,l=[["class","poll"]];r.status||l.push(["data-poll-status","open"]),_.forEach(function(e){r[e]&&l.push(["data-poll-"+e,r[e]])}),r.name||l.push(["data-poll-name","poll"]);var u=parseInt(r.min,10),c=parseInt(r.max,10),d=parseInt(r.step,10);d<1&&(d=1);var p=[],f=new e.Token("poll_open","div",1);if(f.block=!0,f.attrs=l,p.push(f),f=new e.Token("poll_open","div",1),f.block=!0,p.push(f),f=new e.Token("poll_open","div",1),f.attrs=[["class","poll-container"]],p.push(f),"number"===r.type){if(isNaN(u)&&(u=1),isNaN(c)&&(c=e.md.options.discourse.pollMaximumOptions),isNaN(d)&&(d=1),a.length>0)return i(e,o);f=new e.Token("bullet_list_open","ul",1),p.push(f);for(var m=u;m<=c;m+=d)f=new e.Token("list_item_open","li",1),a.push([f,String(m)]),p.push(f),f=new e.Token("text","",0),f.content=String(m),p.push(f),f=new e.Token("list_item_close","li",-1),p.push(f);f=new e.Token("bullet_item_close","",-1),p.push(f)}for(var h=0;h<a.length;h++){f=a[h][0];var b=a[h][1];f.attrs=f.attrs||[];var v=g(JSON.stringify([b]));f.attrs.push(["data-poll-option-id",v])}n(e.tokens,t,p),e.level=e.tokens[e.tokens.length-1].level,e.push("poll_close","div",-1),f=e.push("poll_open","div",1),f.attrs=[["class","poll-info"]],e.push("paragraph_open","p",1),f=e.push("span_open","span",1),f.block=!1,f.attrs=[["class","info-number"]],f=e.push("text","",0),f.content="0",e.push("span_close","span",-1),f=e.push("span_open","span",1),f.block=!1,f.attrs=[["class","info-label"]],f=e.push("text","",0),f.content=I18n.t("poll.voters",{count:0}),e.push("span_close","span",-1),e.push("paragraph_close","p",-1),e.push("poll_close","div",-1),e.push("poll_close","div",-1),e.push("poll_close","div",-1)}},w="0123456789abcdef".split("")}),define("discourse/plugins/poll/lib/even-round",["exports"],function(e){"use strict";function t(e){return 100===e.map(function(e){return Math.floor(e)}).reduce(function(e,t){return e+t})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){for(var n=e.map(function(e){return e%1}),s=Math.ceil(n.reduce(function(e,t){return e+t})),i=0,o=n.length;i<s&&i<o;i++){for(var a=0,r=0,l=0;l<n.length;l++)n[l]>a&&(r=l,a=n[l]);if(++e[r],n[r]=0,t(e))break}return e.map(function(e){return Math.floor(e)})}}),Ember.TEMPLATES["javascripts/modal/poll-ui-builder"]=Ember.HTMLBars.template({id:null,
block:'{"symbols":[],"statements":[[4,"d-modal-body",null,[["title","class"],["poll.ui_builder.title","poll-ui-builder"]],{"statements":[[0,"  "],[7,"form"],[11,"class","poll-ui-builder-form form-horizontal"],[9],[0,"\\n    "],[7,"div"],[11,"class","input-group poll-select"],[9],[0,"\\n      "],[7,"label"],[11,"class","input-group-label"],[9],[1,[27,"i18n",["poll.ui_builder.poll_type.label"],null],false],[10],[0,"\\n      "],[1,[27,"combo-box",null,[["content","value","allowInitialValueMutation","valueAttribute"],[[23,["pollTypes"]],[23,["pollType"]],true,"value"]]],false],[0,"\\n    "],[10],[0,"\\n\\n    "],[7,"div"],[11,"class","input-group poll-select"],[9],[0,"\\n      "],[7,"label"],[11,"class","input-group-label"],[9],[1,[27,"i18n",["poll.ui_builder.poll_result.label"],null],false],[10],[0,"\\n      "],[1,[27,"combo-box",null,[["content","value","allowInitialValueMutation","valueAttribute"],[[23,["pollResults"]],[23,["pollResult"]],true,"value"]]],false],[0,"\\n    "],[10],[0,"\\n\\n\\n"],[4,"if",[[23,["showMinMax"]]],null,{"statements":[[0,"      "],[7,"div"],[11,"class","input-group poll-number"],[9],[0,"\\n        "],[1,[27,"input-tip",null,[["validation"],[[23,["minMaxValueValidation"]]]]],false],[0,"\\n        "],[7,"label"],[11,"class","input-group-label"],[9],[1,[27,"i18n",["poll.ui_builder.poll_config.min"],null],false],[10],[0,"\\n        "],[1,[27,"input",null,[["type","value","valueAttribute","class"],["number",[23,["pollMin"]],"value","poll-options-min"]]],false],[0,"\\n      "],[10],[0,"\\n\\n\\n      "],[7,"div"],[11,"class","input-group poll-number"],[9],[0,"\\n        "],[7,"label"],[11,"class","input-group-label"],[9],[1,[27,"i18n",["poll.ui_builder.poll_config.max"],null],false],[10],[0,"\\n        "],[1,[27,"input",null,[["type","value","valueAttribute","class"],["number",[23,["pollMax"]],"value","poll-options-max"]]],false],[0,"\\n      "],[10],[0,"\\n\\n"],[4,"if",[[23,["isNumber"]]],null,{"statements":[[0,"        "],[7,"div"],[11,"class","input-group poll-number"],[9],[0,"\\n          "],[7,"label"],[11,"class","input-group-label"],[9],[1,[27,"i18n",["poll.ui_builder.poll_config.step"],null],false],[10],[0,"\\n          "],[1,[27,"input",null,[["type","value","valueAttribute","min","class"],["number",[23,["pollStep"]],"value","1","poll-options-step"]]],false],[0,"\\n          "],[1,[27,"input-tip",null,[["validation"],[[23,["minStepValueValidation"]]]]],false],[0,"\\n        "],[10],[0,"\\n"]],"parameters":[]},null]],"parameters":[]},null],[0,"\\n"],[4,"unless",[[23,["isNumber"]]],null,{"statements":[[0,"      "],[7,"div"],[11,"class","input-group poll-textarea"],[9],[0,"\\n        "],[7,"label"],[9],[1,[27,"i18n",["poll.ui_builder.poll_options.label"],null],false],[10],[0,"\\n        "],[1,[27,"textarea",null,[["value","autocomplete"],[[23,["pollOptions"]],"discourse"]]],false],[0,"\\n        "],[1,[27,"input-tip",null,[["validation"],[[23,["minNumOfOptionsValidation"]]]]],false],[0,"\\n      "],[10],[0,"\\n"]],"parameters":[]},null],[0,"\\n    "],[7,"div"],[11,"class","input-group poll-checkbox"],[9],[0,"\\n      "],[7,"label"],[9],[0,"\\n        "],[1,[27,"input",null,[["type","checked"],["checkbox",[23,["publicPoll"]]]]],false],[0,"\\n        "],[1,[27,"i18n",["poll.ui_builder.poll_public.label"],null],false],[0,"\\n      "],[10],[0,"\\n    "],[10],[0,"\\n\\n    "],[7,"div"],[11,"class","input-group poll-checkbox"],[9],[0,"\\n      "],[7,"label"],[9],[0,"\\n        "],[1,[27,"input",null,[["type","checked"],["checkbox",[23,["autoClose"]]]]],false],[0,"\\n        "],[1,[27,"i18n",["poll.ui_builder.automatic_close.label"],null],false],[0,"\\n      "],[10],[0,"\\n    "],[10],[0,"\\n\\n"],[4,"if",[[23,["autoClose"]]],null,{"statements":[[0,"      "],[7,"div"],[11,"class","input-group"],[9],[0,"\\n        "],[1,[27,"date-picker-future",null,[["value","containerId"],[[23,["date"]],"date-container"]]],false],[0,"\\n        "],[1,[27,"input",null,[["type","value"],["time",[23,["time"]]]]],false],[0,"\\n        "],[7,"div"],[11,"id","date-container"],[9],[10],[0,"\\n      "],[10],[0,"\\n"]],"parameters":[]},null],[0,"  "],[10],[0,"\\n"]],"parameters":[]},null],[0,"\\n"],[7,"div"],[11,"class","modal-footer"],[9],[0,"\\n  "],[1,[27,"d-button",null,[["action","icon","class","label","disabled"],[[27,"action",[[22,0,[]],"insertPoll"],null],"chart-bar","btn-primary","poll.ui_builder.insert",[23,["disableInsert"]]]]],false],[0,"\\n"],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/modal/poll-ui-builder"}}),define("discourse/plugins/poll/initializers/add-poll-ui-builder",["exports","discourse/lib/plugin-api","ember-addons/ember-computed-decorators","discourse/lib/show-modal"],function(e,t,n,s){"use strict";function i(e,t,n,s,i){var o={};return Object.keys(s).forEach(function(e){o[e]=s[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}function o(e){var t,o;e.modifyClass("controller:composer",(t=(0,n.default)("siteSettings.poll_enabled","siteSettings.poll_minimum_trust_level_to_create","model.topic.pm_with_non_human_user"),o={canBuildPoll:function(e,t,n){return e&&(n||this.currentUser&&(this.currentUser.staff||this.currentUser.trust_level>=t))},actions:{showPollBuilder:function(){(0,s.default)("poll-ui-builder").set("toolbarEvent",this.get("toolbarEvent"))}}},i(o,"canBuildPoll",[t],Object.getOwnPropertyDescriptor(o,"canBuildPoll"),o),o)),e.addToolbarPopupMenuOptionsCallback(function(){return{action:"showPollBuilder",icon:"chart-bar",label:"poll.ui_builder.title",condition:"canBuildPoll"}})}Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"add-poll-ui-builder",initialize:function(){(0,t.withPluginApi)("0.8.7",o)}}}),define("discourse/plugins/poll/initializers/extend-for-poll",["exports","discourse/lib/plugin-api","ember-addons/ember-computed-decorators","discourse-common/lib/get-owner","discourse/widgets/glue"],function(e,t,n,s,i){"use strict";function o(e,t,n,s,i){var o={};return Object.keys(s).forEach(function(e){o[e]=s[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}function a(e){function t(){d.forEach(function(e){return e.queueRerender()})}function a(n,s){var o=$(".poll",n);if(o.length&&s){var a=s.getModel();e.preventCloak(a.id);var r=a.get("polls_votes")||{};a.pollsChanged();var l=a.get("pollsObject");l&&(p=p||setInterval(t,3e4),o.each(function(e,t){var n=$(t),s=n.data("poll-name"),o=l[s];if(o){var u=new i.default("discourse-poll",c,{id:s+"-"+a.id,post:a,poll:o,vote:r[s]||[]});u.appendTo(t),d.push(u)}}))}}function r(){p&&(clearInterval(p),p=null),d.forEach(function(e){return e.cleanUp()}),d=[]}var l,u,c=(0,s.getRegister)(e);e.modifyClass("controller:topic",{subscribe:function(){var e=this;this._super.apply(this,arguments),this.messageBus.subscribe("/polls/"+this.get("model.id"),function(t){var n=e.get("model.postStream").findLoadedPost(t.post_id);n&&n.set("polls",t.polls)})},unsubscribe:function(){this.messageBus.unsubscribe("/polls/*"),this._super.apply(this,arguments)}});var d=[],p=null;e.modifyClass("model:post",(l=(0,n.observes)("polls"),u={_polls:null,pollsObject:null,pollsChanged:function(){var e=this,n=this.get("polls");n&&(this._polls=this._polls||{},n.forEach(function(t){e._polls[t.name]?e._polls[t.name].setProperties(t):e._polls[t.name]=Ember.Object.create(t)}),this.set("pollsObject",this._polls),t())}},o(u,"pollsChanged",[l],Object.getOwnPropertyDescriptor(u,"pollsChanged"),u),u)),e.includePostAttributes("polls","polls_votes"),e.decorateCooked(a,{onlyStream:!0}),e.cleanupStream(r)}Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"extend-for-poll",initialize:function(){(0,t.withPluginApi)("0.8.7",a)}}}),define("discourse/plugins/poll/controllers/poll-ui-builder",["exports","ember-addons/ember-computed-decorators","discourse/models/input-validation"],function(e,t,n){"use strict";function s(e,t,n,s,i){var o={};return Object.keys(s).forEach(function(e){o[e]=s[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}Object.defineProperty(e,"__esModule",{value:!0});var i,o,a,r,l,u,c,d,p,f,m,h,b,v,g,y,w;e.default=Ember.Controller.extend((i=(0,t.default)("regularPollType","numberPollType","multiplePollType"),o=(0,t.default)("alwaysPollResult","votePollResult","closedPollResult"),a=(0,t.default)("pollType","regularPollType"),r=(0,t.default)("pollType","pollOptionsCount","multiplePollType"),l=(0,t.default)("pollType","numberPollType"),u=(0,t.default)("isRegular"),c=(0,t.default)("pollOptions"),d=(0,t.observes)("isMultiple","isNumber","pollOptionsCount"),p=(0,t.default)("isRegular","isMultiple","isNumber","pollOptionsCount"),f=(0,t.default)("isRegular","isMultiple","isNumber","pollOptionsCount","pollMin","pollStep"),m=(0,t.default)("isNumber","pollMax"),h=(0,t.default)("isNumber","showMinMax","pollType","pollResult","publicPoll","pollOptions","pollMin","pollMax","pollStep","autoClose","date","time"),b=(0,t.default)("pollOptionsCount","isRegular","isMultiple","isNumber","pollMin","pollMax"),v=(0,t.default)("pollMin","pollMax"),g=(0,t.default)("pollStep"),y=(0,t.default)("disableInsert"),w={regularPollType:"regular",numberPollType:"number",multiplePollType:"multiple",alwaysPollResult:"always",votePollResult:"on_vote",closedPollResult:"on_close",init:function(){this._super.apply(this,arguments),this._setupPoll()},pollTypes:function(e,t,n){return[{name:I18n.t("poll.ui_builder.poll_type.regular"),value:e},{name:I18n.t("poll.ui_builder.poll_type.number"),value:t},{name:I18n.t("poll.ui_builder.poll_type.multiple"),value:n}]},pollResults:function(e,t,n){return[{name:I18n.t("poll.ui_builder.poll_result.always"),value:e},{name:I18n.t("poll.ui_builder.poll_result.vote"),value:t},{name:I18n.t("poll.ui_builder.poll_result.closed"),value:n}]},isRegular:function(e,t){return e===t},isMultiple:function(e,t,n){return e===n&&t>0},isNumber:function(e,t){return e===t},showMinMax:function(e){return!e},pollOptionsCount:function(e){if(0===e.length)return 0;var t=0;return e.split("\n").forEach(function(e){0!==e.length&&(t+=1)}),t},_setPollMax:function(){var e=this.get("isMultiple"),t=this.get("isNumber");(e||t)&&(e?this.set("pollMax",this.get("pollOptionsCount")):t&&this.set("pollMax",this.siteSettings.poll_maximum_options))},pollMinOptions:function(e,t,n,s){if(!e)return t?this._comboboxOptions(1,s+1):n?this._comboboxOptions(1,this.siteSettings.poll_maximum_options+1):void 0},pollMaxOptions:function(e,t,n,s,i,o){if(!e){var a=parseInt(i)||1;if(t)return this._comboboxOptions(a+1,s+1);if(n){var r=parseInt(o,10);return r<1&&(r=1),this._comboboxOptions(a+1,a+this.siteSettings.poll_maximum_options*r)}}},pollStepOptions:function(e,t){if(e)return this._comboboxOptions(1,(parseInt(t)||1)+1)},pollOutput:function(e,t,n,s,i,o,a,r,l,u,c,d){var p="[poll",f="",m=this.get("toolbarEvent").getText().match(/\[poll(\s+name=[^\s\]]+)*.*\]/gim);m&&(p+=" name=poll"+(m.length+1));var h=l;if(h<1&&(h=1),n&&(p+=" type="+n),s&&(p+=" results="+s),a&&t&&(p+=" min="+a),r&&(p+=" max="+r),e&&(p+=" step="+h),i&&(p+=" public=true"),u){var b=moment(c+" "+d,"YYYY-MM-DD HH:mm").toISOString();b&&(p+=" close="+b)}return p+="]",f+=p+"\n",o.length>0&&!e&&o.split("\n").forEach(function(e){0!==e.length&&(f+="* "+e+"\n")}),f+="[/poll]"},disableInsert:function(e,t,n,s,i,o){return t&&e<2||n&&e<i&&i>=o||!s&&e<2},minMaxValueValidation:function(e,t){var s={ok:!0};return e>=t&&(s={failed:!0,reason:I18n.t("poll.ui_builder.help.invalid_values")}),n.default.create(s)},minStepValueValidation:function(e){var t={ok:!0};return e<1&&(t={failed:!0,reason:I18n.t("poll.ui_builder.help.min_step_value")}),n.default.create(t)},minNumOfOptionsValidation:function(e){var t={ok:!0};return e&&(t={failed:!0,reason:I18n.t("poll.ui_builder.help.options_count")}),n.default.create(t)},_comboboxOptions:function(e,t){return _.range(e,t).map(function(e){return{value:e,name:e}})},_setupPoll:function(){this.setProperties({pollType:null,publicPoll:!1,pollOptions:"",pollMin:1,pollMax:null,pollStep:1,autoClose:!1,date:moment().add(1,"day").format("YYYY-MM-DD"),time:moment().add(1,"hour").format("HH:mm")})},actions:{insertPoll:function(){this.get("toolbarEvent").addText(this.get("pollOutput")),this.send("closeModal"),this._setupPoll()}}},s(w,"pollTypes",[i],Object.getOwnPropertyDescriptor(w,"pollTypes"),w),s(w,"pollResults",[o],Object.getOwnPropertyDescriptor(w,"pollResults"),w),s(w,"isRegular",[a],Object.getOwnPropertyDescriptor(w,"isRegular"),w),s(w,"isMultiple",[r],Object.getOwnPropertyDescriptor(w,"isMultiple"),w),s(w,"isNumber",[l],Object.getOwnPropertyDescriptor(w,"isNumber"),w),s(w,"showMinMax",[u],Object.getOwnPropertyDescriptor(w,"showMinMax"),w),s(w,"pollOptionsCount",[c],Object.getOwnPropertyDescriptor(w,"pollOptionsCount"),w),s(w,"_setPollMax",[d],Object.getOwnPropertyDescriptor(w,"_setPollMax"),w),s(w,"pollMinOptions",[p],Object.getOwnPropertyDescriptor(w,"pollMinOptions"),w),s(w,"pollMaxOptions",[f],Object.getOwnPropertyDescriptor(w,"pollMaxOptions"),w),s(w,"pollStepOptions",[m],Object.getOwnPropertyDescriptor(w,"pollStepOptions"),w),s(w,"pollOutput",[h],Object.getOwnPropertyDescriptor(w,"pollOutput"),w),s(w,"disableInsert",[b],Object.getOwnPropertyDescriptor(w,"disableInsert"),w),s(w,"minMaxValueValidation",[v],Object.getOwnPropertyDescriptor(w,"minMaxValueValidation"),w),s(w,"minStepValueValidation",[g],Object.getOwnPropertyDescriptor(w,"minStepValueValidation"),w),s(w,"minNumOfOptionsValidation",[y],Object.getOwnPropertyDescriptor(w,"minNumOfOptionsValidation"),w),w))}),define("discourse/plugins/poll/widgets/discourse-poll",["exports","discourse/widgets/widget","virtual-dom","discourse-common/lib/icon-library","discourse/widgets/raw-html","discourse/lib/ajax","discourse/lib/ajax-error","discourse/plugins/poll/lib/even-round","discourse/widgets/post","discourse/lib/round","discourse/lib/formatter"],function(e,t,n,s,i,o,a,r,l,u,c){"use strict";function d(e){return new i.default({html:"<span>"+e.html+"</span>"})}function p(e){return new i.default({html:'<span class="info-text">'+e+"</span>"})}function f(e){return(0,o.ajax)("/polls/voters.json",{data:e}).catch(function(e){e?(0,a.popupAjaxError)(e):bootbox.alert(I18n.t("poll.error_while_fetching_voters"))})}Object.defineProperty(e,"__esModule",{value:!0}),(0,t.createWidget)("discourse-poll-option",{tagName:"li",buildAttributes:function(e){return{"data-poll-option-id":e.option.id}},html:function(e){var t=[],n=e.option,i=e.vote,o=i.includes(n.id);return e.isMultiple?t.push((0,s.iconNode)(o?"far-check-square":"far-square")):t.push((0,s.iconNode)(o?"circle":"far-circle")),t.push(" "),t.push(d(n)),t},click:function(e){0===$(e.target).closest("a").length&&this.sendWidgetAction("toggleOption",this.attrs.option)}}),(0,t.createWidget)("discourse-poll-load-more",{tagName:"div.poll-voters-toggle-expand",buildKey:function(e){return"load-more-"+e.optionId},defaultState:function(){return{loading:!1}},html:function(e,t){return t.loading?(0,n.h)("div.spinner.small"):(0,n.h)("a",(0,s.iconNode)("chevron-down"))},click:function(){var e=this.state;if(!e.loading)return e.loading=!0,this.sendWidgetAction("loadMore").finally(function(){return e.loading=!1})}}),(0,t.createWidget)("discourse-poll-voters",{tagName:"ul.poll-voters-list",buildKey:function(e){return"poll-voters-"+e.optionId},defaultState:function(){return{loaded:"new",voters:[],page:1}},fetchVoters:function(){var e=this,t=this.attrs,n=this.state;if("loading"!==n.loaded)return n.loaded="loading",f({post_id:t.postId,poll_name:t.pollName,option_id:t.optionId,page:n.page}).then(function(s){n.loaded="loaded",n.page+=1;var i="number"===t.pollType?s.voters:s.voters[t.optionId],o=new Set(n.voters.map(function(e){return e.username}));i.forEach(function(e){o.has(e.username)||(o.add(e.username),n.voters.push(e))}),e.scheduleRerender()})},loadMore:function(){return this.fetchVoters()},html:function(e,t){e.voters&&"new"===t.loaded&&(t.voters=e.voters);var s=t.voters.map(function(e){return(0,n.h)("li",[(0,l.avatarFor)("tiny",{username:e.username,template:e.avatar_template})," "])});return t.voters.length<e.totalVotes&&s.push(this.attach("discourse-poll-load-more",e)),(0,n.h)("div.poll-voters",s)}}),(0,t.createWidget)("discourse-poll-standard-results",{tagName:"ul.results",buildKey:function(e){return"poll-standard-results-"+e.id},defaultState:function(){return{loaded:!1}},fetchVoters:function(){var e=this,t=this.attrs,n=this.state;return f({post_id:t.post.id,poll_name:t.poll.get("name")}).then(function(t){n.voters=t.voters,e.scheduleRerender()})},html:function(e,t){var s=this,i=e.poll,o=i.get("options");if(o){var a=i.get("voters"),l=i.get("public"),u=_.clone(o).sort(function(e,t){return e.votes<t.votes?1:e.votes===t.votes?e.html<t.html?-1:1:-1});l&&!t.loaded&&(t.voters=i.get("preloaded_voters"),t.loaded=!0);var c=0===a?Array(u.length).fill(0):u.map(function(e){return 100*e.votes/a}),p=e.isMultiple?c.map(Math.floor):(0,r.default)(c);return u.map(function(o,a){var r=[],u=p[a].toString(),c=(e.vote||[]).includes(o.id);return r.push((0,n.h)("div.option",(0,n.h)("p",[(0,n.h)("span.percentage",u+"%"),d(o)]))),r.push((0,n.h)("div.bar-back",(0,n.h)("div.bar",{attributes:{style:"width:"+u+"%"}}))),l&&r.push(s.attach("discourse-poll-voters",{postId:e.post.id,optionId:o.id,pollName:i.get("name"),totalVotes:o.votes,voters:t.voters&&t.voters[o.id]||[]})),(0,n.h)("li",{className:c?"chosen":""},r)})}}}),(0,t.createWidget)("discourse-poll-number-results",{buildKey:function(e){return"poll-number-results-"+e.id},defaultState:function(){return{loaded:!1}},fetchVoters:function(){var e=this,t=this.attrs,n=this.state;return f({post_id:t.post.id,poll_name:t.poll.get("name")}).then(function(t){n.voters=t.voters,e.scheduleRerender()})},html:function(e,t){var s=e.poll,o=s.get("options").reduce(function(e,t){return e+parseInt(t.html,10)*parseInt(t.votes,10)},0),a=s.get("voters"),r=0===a?0:(0,u.default)(o/a,-2),l=I18n.t("poll.average_rating",{average:r}),c=[(0,n.h)("div.poll-results-number-rating",new i.default({html:"<span>"+l+"</span>"}))];return s.get("public")&&(t.loaded||(t.voters=s.get("preloaded_voters"),t.loaded=!0),c.push(this.attach("discourse-poll-voters",{totalVotes:s.get("voters"),voters:t.voters||[],postId:e.post.id,pollName:s.get("name"),pollType:s.get("type")}))),c}}),(0,t.createWidget)("discourse-poll-container",{tagName:"div.poll-container",html:function(e){var t=this,s=e.poll,i=s.get("options");if(e.showResults){var o="number"===s.get("type")?"number":"standard";return this.attach("discourse-poll-"+o+"-results",e)}if(i)return(0,n.h)("ul",i.map(function(n){return t.attach("discourse-poll-option",{option:n,isMultiple:e.isMultiple,vote:e.vote})}))}}),(0,t.createWidget)("discourse-poll-info",{tagName:"div.poll-info",multipleHelpText:function(e,t,n){if(t>0)if(e===t){if(e>1)return I18n.t("poll.multiple.help.x_options",{count:e})}else{if(e>1)return t<n?I18n.t("poll.multiple.help.between_min_and_max_options",{min:e,max:t}):I18n.t("poll.multiple.help.at_least_min_options",{count:e});if(t<=n)return I18n.t("poll.multiple.help.up_to_max_options",{count:t})}},html:function(e){var t=e.poll,s=t.get("voters"),i=[(0,n.h)("p",[(0,n.h)("span.info-number",s.toString()),(0,n.h)("span.info-label",I18n.t("poll.voters",{count:s}))])];if(e.isMultiple)if(e.showResults||e.isClosed){var o=t.get("options").reduce(function(e,t){return e+parseInt(t.votes,10)},0);i.push((0,n.h)("p",[(0,n.h)("span.info-number",o.toString()),(0,n.h)("span.info-label",I18n.t("poll.total_votes",{count:o}))]))}else{var a=this.multipleHelpText(e.min,e.max,t.get("options.length"));a&&i.push(p(a))}return e.isClosed||e.showResults||!t.get("public")||i.push(p(I18n.t("poll.public.title"))),i}}),(0,t.createWidget)("discourse-poll-buttons",{tagName:"div.poll-buttons",html:function(e){var t=[],n=e.poll,s=e.post,o=s.get("topic.archived"),a=e.isClosed,r=a||o;if(e.isMultiple&&!r){var l=!e.canCastVotes;t.push(this.attach("button",{className:"btn cast-votes "+(l?"btn-default":"btn-primary"),label:"poll.cast-votes.label",title:"poll.cast-votes.title",disabled:l,action:"castVotes"})),t.push(" ")}if(e.showResults||r?t.push(this.attach("button",{className:"btn btn-default toggle-results",label:"poll.hide-results.label",title:"poll.hide-results.title",icon:"far-eye-slash",disabled:r,action:"toggleResults"})):"on_vote"!==n.get("results")||e.hasVoted?"on_close"!==n.get("results")||a?t.push(this.attach("button",{className:"btn btn-default toggle-results",label:"poll.show-results.label",title:"poll.show-results.title",icon:"far-eye",disabled:0===n.get("voters"),action:"toggleResults"})):t.push(p(I18n.t("poll.results.closed.title"))):t.push(p(I18n.t("poll.results.vote.title"))),n.get("close")){var u=moment.utc(n.get("close"));if(u.isValid()){var d=u.format("LLL"),f=void 0;if(e.isAutomaticallyClosed){var m=(0,c.relativeAge)(u.toDate(),{addAgo:!0});f=I18n.t("poll.automatic_close.age",{age:m})}else{var h=moment().to(u.local(),!0);f=I18n.t("poll.automatic_close.closes_in",{timeLeft:h})}t.push(new i.default({html:'<span class="info-text" title="'+d+'">'+f+"</span>"}))}}return!this.currentUser||this.currentUser.get("id")!==s.get("user_id")&&!this.currentUser.get("staff")||o||(a?e.isAutomaticallyClosed||t.push(this.attach("button",{className:"btn btn-default toggle-status",label:"poll.open.label",title:"poll.open.title",icon:"unlock-alt",action:"toggleStatus"})):t.push(this.attach("button",{className:"btn toggle-status btn-danger",label:"poll.close.label",title:"poll.close.title",icon:"lock",action:"toggleStatus"}))),t}}),e.default=(0,t.createWidget)("discourse-poll",{tagName:"div.poll",buildKey:function(e){return"poll-"+e.id},buildAttributes:function(e){return{"data-poll-name":e.poll.get("name"),"data-poll-type":e.poll.get("type")}},defaultState:function(e){var t=e.post,n=e.poll;return{loading:!1,showResults:t.get("topic.archived")||this.isClosed()||"on_close"!==n.get("results")&&this.hasVoted()}},html:function(e,t){var s=t.showResults||e.post.get("topic.archived")||this.isClosed(),i=jQuery.extend({},e,{canCastVotes:this.canCastVotes(),hasVoted:this.hasVoted(),isAutomaticallyClosed:this.isAutomaticallyClosed(),isClosed:this.isClosed(),isMultiple:this.isMultiple(),max:this.max(),min:this.min(),showResults:s});return(0,n.h)("div",[this.attach("discourse-poll-container",i),this.attach("discourse-poll-info",i),this.attach("discourse-poll-buttons",i)])},min:function(){var e=parseInt(this.attrs.poll.get("min"),10);return(isNaN(e)||e<0)&&(e=0),e},max:function(){var e=parseInt(this.attrs.poll.get("max"),10),t=this.attrs.poll.get("options.length");return(isNaN(e)||e>t)&&(e=t),e},isAutomaticallyClosed:function(){var e=this.attrs.poll;return e.get("close")&&moment.utc(e.get("close"))<=moment()},isClosed:function(){return"closed"===this.attrs.poll.get("status")||this.isAutomaticallyClosed()},isMultiple:function(){return"multiple"===this.attrs.poll.get("type")},hasVoted:function(){var e=this.attrs.vote;return e&&e.length>0},canCastVotes:function(){var e=this.state,t=this.attrs;if(this.isClosed()||e.showResults||e.loading)return!1;var n=t.vote.length;return this.isMultiple()?n>=this.min()&&n<=this.max():n>0},toggleStatus:function(){var e=this,t=this.state,n=this.attrs,s=n.post,i=n.poll;this.isAutomaticallyClosed()||bootbox.confirm(I18n.t(this.isClosed()?"poll.open.confirm":"poll.close.confirm"),I18n.t("no_value"),I18n.t("yes_value"),function(n){if(n){t.loading=!0;var r=e.isClosed()?"open":"closed";(0,o.ajax)("/polls/toggle_status",{type:"PUT",data:{post_id:s.get("id"),poll_name:i.get("name"),status:r}}).then(function(){i.set("status",r),"on_close"===i.get("results")&&(t.showResults="closed"===r),e.scheduleRerender()}).catch(function(e){e?(0,a.popupAjaxError)(e):bootbox.alert(I18n.t("poll.error_while_toggling_status"))}).finally(function(){t.loading=!1})}})},toggleResults:function(){this.state.showResults=!this.state.showResults},showLogin:function(){this.register.lookup("route:application").send("showLogin")},toggleOption:function(e){var t=this.attrs;if(!this.isClosed()){if(!this.currentUser)return this.showLogin();var n=t.vote,s=n.indexOf(e.id);return this.isMultiple()||(n.length=0),-1!==s?n.splice(s,1):n.push(e.id),this.isMultiple()?void 0:this.castVotes()}},castVotes:function(){if(this.canCastVotes()){if(!this.currentUser)return this.showLogin();var e=this.attrs,t=this.state;return t.loading=!0,(0,o.ajax)("/polls/vote",{type:"PUT",data:{post_id:e.post.id,poll_name:e.poll.get("name"),options:e.vote}}).then(function(n){var s=n.poll;e.poll.setProperties(s),"on_close"!==e.poll.get("results")&&(t.showResults=!0)}).catch(function(e){e?(0,a.popupAjaxError)(e):bootbox.alert(I18n.t("poll.error_while_casting_votes"))}).finally(function(){t.loading=!1})}}})});
//# sourceMappingURL=/assets/plugin-340a69e6f92f976b8abbcfdeced24253b29ab2bf22bdfccdb24c951b96f1d456.js.map